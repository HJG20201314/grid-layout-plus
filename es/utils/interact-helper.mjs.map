{"version":3,"file":"interact-helper.mjs","sources":["../../src/utils/interact-helper.ts"],"sourcesContent":["import interact from 'interactjs'\r\nimport { throttle } from '@vexip-ui/utils'\r\n\r\nimport { isCssUnitValue, parseCssSize, parsePositionValue } from './css-units'\r\n\r\nimport type { DragEvent, Interactable, ResizeEvent } from '@interactjs/types'\r\n\r\n\r\n/** 扩展Element类型以支持_dataUpdateTimer属性和事件监听器引用 */\r\ndeclare global {\r\n  interface Element {\r\n    _dataUpdateTimer?: ReturnType<typeof setTimeout>,\r\n    _resizeRAF?: number\r\n  }\r\n\r\n  interface HTMLElement {\r\n    _mouseEnterListener?: (event: MouseEvent) => void,\r\n    _mouseLeaveListener?: (event: MouseEvent) => void\r\n  }\r\n}\r\n\r\n/** 优化常量 */\r\nconst DEFAULT_THROTTLE_DELAY = 2 // 极低节流阈值以获得极致流畅度\r\n\r\n/** Modifier类型定义，从interactjs类型系统中推断 */\r\nexport type Modifier = any\r\n\r\n/**\r\n * 边缘配置接口\r\n */\r\nexport interface ElementEdges {\r\n  /** 是否启用顶部边缘 */\r\n  top?: boolean,\r\n  /** 是否启用右侧边缘 */\r\n  right?: boolean,\r\n  /** 是否启用底部边缘 */\r\n  bottom?: boolean,\r\n  /** 是否启用左侧边缘 */\r\n  left?: boolean\r\n}\r\n\r\n/**\r\n * 拖拽配置选项\r\n */\r\nexport interface DragOptions {\r\n  /** 是否启用拖拽功能 */\r\n  enabled?: boolean,\r\n  /** 允许触发拖拽的元素选择器或DOM元素 */\r\n  allowFrom?: string | HTMLElement,\r\n  /** 忽略拖拽的元素选择器或DOM元素 */\r\n  ignoreFrom?: string | HTMLElement,\r\n  /** 拖拽修饰器数组 */\r\n  modifiers?: Modifier[],\r\n  /** 拖拽节流阈值（毫秒） */\r\n  threshold?: number,\r\n  /** 限制初始拖拽方向 */\r\n  startAxis?: 'x' | 'y' | 'xy',\r\n  /** 锁定拖拽轴方向 */\r\n  lockAxis?: 'x' | 'y' | 'xy' | 'start',\r\n  /** 最大可拖拽次数 */\r\n  max?: number,\r\n  /** 每个元素最大可拖拽次数 */\r\n  maxPerElement?: number\r\n}\r\n\r\n/**\r\n * 调整大小配置选项\r\n */\r\nexport interface ResizeOptions {\r\n  /** 是否启用调整大小功能 */\r\n  enabled?: boolean,\r\n  /** 可调整大小的边缘配置 */\r\n  edges?: ElementEdges,\r\n  /** 调整大小边缘的外边距 */\r\n  margin?: number,\r\n  /** 调整大小修饰器数组 */\r\n  modifiers?: Modifier[],\r\n  /** 调整大小节流阈值（毫秒） */\r\n  threshold?: number,\r\n  // 支持更多interactjs原生配置选项\r\n  /** 是否限制为正方形调整大小 */\r\n  square?: boolean,\r\n  /** 是否保持宽高比 */\r\n  preserveAspectRatio?: boolean,\r\n  /** 调整大小反转行为 */\r\n  invert?: 'none' | 'negate' | 'reposition',\r\n  /** 最大可调整大小次数 */\r\n  max?: number,\r\n  /** 每个元素最大可调整大小次数 */\r\n  maxPerElement?: number,\r\n  /** 最小宽度 */\r\n  minWidth?: number | string,\r\n  /** 最小高度 */\r\n  minHeight?: number | string,\r\n  /** 最大宽度 */\r\n  maxWidth?: number | string,\r\n  /** 最大高度 */\r\n  maxHeight?: number | string,\r\n  /** 调整大小热区大小 */\r\n  hotZoneSize?: number\r\n}\r\n\r\n/**\r\n * 拖拽调整大小配置接口\r\n */\r\nexport interface ElementDragResizeOptions {\r\n  /** 是否启用拖拽功能 */\r\n  draggable?: boolean,\r\n  /** 是否启用调整大小功能 */\r\n  resizable?: boolean,\r\n  /** 拖拽配置选项 */\r\n  dragOptions?: DragOptions,\r\n  /** 调整大小配置选项 */\r\n  resizeOptions?: ResizeOptions,\r\n  /** 是否使用CSS transform进行定位 */\r\n  useCssTransforms?: boolean,\r\n  /** 初始元素顶部位置 (支持数字或CSS单位) */\r\n  x?: number | string,\r\n  /** 初始元素左侧位置 (支持数字或CSS单位) */\r\n  y?: number | string,\r\n  /** 初始元素宽度 (支持数字或CSS单位) */\r\n  width?: number | string,\r\n  /** 初始元素高度 (支持数字或CSS单位) */\r\n  height?: number | string\r\n}\r\n\r\n/**\r\n * 拖拽事件回调数据\r\n */\r\nexport interface DragEventCallbackData {\r\n  /** 事件类型 */\r\n  type: 'dragstart' | 'dragmove' | 'dragend',\r\n  /** 元素顶部位置 */\r\n  top: number,\r\n  /** 元素左侧位置 */\r\n  left: number,\r\n  /** X轴移动距离 */\r\n  deltaX: number,\r\n  /** Y轴移动距离 */\r\n  deltaY: number\r\n}\r\n\r\n/**\r\n * 调整大小事件回调数据\r\n */\r\nexport interface ResizeEventCallbackData {\r\n  /** 事件类型 */\r\n  type: 'resizestart' | 'resizemove' | 'resizeend',\r\n  /** 元素宽度 */\r\n  width: number,\r\n  /** 元素高度 */\r\n  height: number,\r\n  /** 元素顶部位置 */\r\n  top: number,\r\n  /** 元素左侧位置 */\r\n  left: number,\r\n  /** 宽度变化量 */\r\n  deltaWidth: number,\r\n  /** 高度变化量 */\r\n  deltaHeight: number,\r\n  /** 调整大小的边缘 */\r\n  edges: Partial<ElementEdges>\r\n}\r\n\r\n/**\r\n * 回调函数接口\r\n */\r\nexport interface ElementDragResizeCallbacks {\r\n  /** 拖拽事件回调函数 */\r\n  onDrag?: (data: DragEventCallbackData) => void,\r\n  /** 调整大小事件回调函数 */\r\n  onResize?: (data: ResizeEventCallbackData) => void\r\n}\r\n\r\n/**\r\n * makeElementDraggableResizable 函数返回的对象类型\r\n */\r\nexport interface DraggableResizableResult {\r\n  /** 清理函数，用于卸载拖拽和调整大小功能 */\r\n  cleanup: () => void,\r\n  /** 同时更新位置和尺寸的方法 (支持数字或CSS单位) */\r\n  updatePositionAndSize: (x: number | string, y: number | string, width: number | string, height: number | string) => void,\r\n  /** 仅更新位置的方法 (支持数字或CSS单位) */\r\n  updatePosition: (x: number | string, y: number | string) => void,\r\n  /** 仅更新尺寸的方法 (支持数字或CSS单位) */\r\n  updateSize: (width: number | string, height: number | string) => void\r\n}\r\n\r\n/**\r\n * 创建元素拖拽调整大小功能\r\n * @param element 目标DOM元素\r\n * @param options 配置选项\r\n * @param callbacks 回调函数\r\n * @returns 包含清理函数和更新位置尺寸方法的对象\r\n */\r\nexport function makeElementDraggableResizable(\r\n  element: HTMLElement | SVGElement,\r\n  options: ElementDragResizeOptions = {},\r\n  callbacks?: ElementDragResizeCallbacks,\r\n): DraggableResizableResult {\r\n  // 默认配置\r\n  const defaultOptions: ElementDragResizeOptions = {\r\n    draggable: true,\r\n    resizable: true,\r\n    useCssTransforms: true,\r\n    dragOptions: {},\r\n    resizeOptions: {\r\n      edges: { top: false, right: false, bottom: false, left: false },\r\n      margin: 8,\r\n      hotZoneSize: 8,\r\n    },\r\n    x: 0,\r\n    y: 0,\r\n    width: 0,\r\n    height: 0,\r\n  }\r\n\r\n  // 合并配置\r\n  const mergedOptions = { ...defaultOptions, ...options }\r\n  const { draggable, resizable, useCssTransforms, dragOptions, resizeOptions } = mergedOptions\r\n\r\n  // 使用通用方式存储数据，兼容所有Element类型\r\n  const getData = (key: string, defaultValue: string): string => {\r\n    return element.getAttribute(`data-${key}`) || defaultValue\r\n  }\r\n  const setData = (key: string, value: string | number) => {\r\n    element.setAttribute(`data-${key}`, value.toString())\r\n  }\r\n\r\n  // 获取初始尺寸\r\n  const rect = element.getBoundingClientRect()\r\n  const width = mergedOptions.width || rect.width || 0\r\n  const height = mergedOptions.height || rect.height || 0\r\n\r\n  /** 初始化数据 - 优先使用已存在的数据属性，如果没有则使用实际尺寸 */\r\n  setData('x', mergedOptions.x || 0)\r\n  setData('y', mergedOptions.y || 0)  \r\n  setData('width', width.toString())\r\n  setData('height', height.toString())\r\n\r\n  const initialX = getData('x', '0')\r\n  const initialY = getData('y', '0')\r\n  const initialWidth = getData('width', width.toString())\r\n  const initialHeight = getData('height', height.toString())\r\n\r\n  // 使用解析后的初始缓存值 (内部统一使用像素值计算)\r\n  let cachedX = parsePositionValue(initialX, element, 'x')\r\n  let cachedY = parsePositionValue(initialY, element, 'y')\r\n  let cachedWidth = parseCssSize(initialWidth, element, 'width')\r\n  let cachedHeight = parseCssSize(initialHeight, element, 'height')\r\n\r\n  /** 创建拖拽线元素 */\r\n  const resizeLines = new Map<string, HTMLElement>()\r\n\r\n  /** 移除cursor相关的样式存储和恢复功能，让使用方完全控制元素的光标样式 */\r\n\r\n  /** 标记状态变量 */\r\n  let isResizing = false\r\n  let isDragging = false\r\n  let activeEdges: Partial<ElementEdges> = {}\r\n\r\n  /** 通用的定位检查函数 */\r\n  const isPositioned = (property: 'left' | 'right' | 'top' | 'bottom') => {\r\n    if (element instanceof HTMLElement) {\r\n      const computedStyle = getComputedStyle(element)\r\n      // 检查position是否为absolute或fixed，并且指定属性有非auto值\r\n      return (computedStyle.position === 'absolute' || computedStyle.position === 'fixed') && \r\n             computedStyle[property] !== 'auto' && computedStyle[property] !== ''\r\n    }\r\n    return false\r\n  }\r\n\r\n  /** 检查元素是否为右侧定位 */\r\n  const isRightPositioned = () => isPositioned('right')\r\n\r\n  /** 检查元素是否为左侧定位 */\r\n  const isLeftPositioned = () => isPositioned('left')\r\n\r\n  /** 检查元素是否为顶部定位 */\r\n  const isTopPositioned = () => isPositioned('top')\r\n\r\n  /** 检查元素是否为底部定位 */\r\n  const isBottomPositioned = () => isPositioned('bottom')\r\n\r\n  /** 共享的缓存变量 - 使用已解析的 cachedX/cachedY/cachedWidth/cachedHeight (CSS单位已转换为像素) */\r\n  // (已在上方通过 parsePositionValue 与 parseCssSize 初始化, 这里不再重复声明)\r\n\r\n  /** 设置拖拽边的hover状态 */\r\n  const setEdgeActive = (edges: Partial<ElementEdges>) => {\r\n    activeEdges = edges\r\n    ;(['top', 'right', 'bottom', 'left'] as const).forEach(edge => {\r\n      const line = resizeLines.get(edge)\r\n      if (line) {\r\n        // 只处理内部线条的背景色，外部线条保持透明\r\n        const innerLine = line.firstElementChild as HTMLElement\r\n        if (innerLine) {\r\n          innerLine.style.backgroundColor = edges[edge] ? 'rgba(29, 98, 236, 1)' : 'rgba(29, 98, 236, 0)'\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  /** 重置所有拖拽边的状态 */\r\n  const resetEdgesActive = () => {\r\n    resizeLines.forEach(line => {\r\n      // 只处理内部线条的背景色，外部线条保持透明\r\n      const innerLine = line.firstElementChild as HTMLElement\r\n      if (innerLine) {\r\n        innerLine.style.backgroundColor = 'rgba(29, 98, 236, 0)'\r\n      }\r\n    })\r\n    activeEdges = {}\r\n  }\r\n\r\n  const createResizeLines = () => {\r\n    const edges = resizeOptions?.edges || {}\r\n    // 获取margin值，默认为4\r\n    const margin = resizeOptions?.margin ?? 4\r\n    // 热区放大尺寸，设置为10px以提高可点击性\r\n    const hotZoneSize = resizeOptions?.hotZoneSize ?? 10\r\n    \r\n    const lineStyle = {\r\n      position: 'absolute',\r\n      backgroundColor: 'rgba(29, 98, 236, 0)', // 始终保持透明\r\n      pointerEvents: 'auto', // 设置为auto以支持hover效果\r\n      // 移除transition，因为背景色不会变化\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n    }\r\n    \r\n    // 内部div样式，用于放大热区\r\n    const innerLineStyle = {\r\n      backgroundColor: 'rgba(29, 98, 236, 0)', // 初始透明\r\n      transition: 'background-color 0.1s ease',\r\n      pointerEvents: 'auto',\r\n    }\r\n\r\n    /** 为线条添加hover效果的函数 */\r\n    const setupHoverEffect = (outerLine: HTMLElement, innerLine: HTMLElement) => {\r\n      /** 鼠标进入时只显示内部线条的背景色 */\r\n      const handleMouseEnter = () => {\r\n        // outerLine保持透明，只设置内部线条的背景色\r\n        innerLine.style.backgroundColor = 'rgba(29, 98, 236, 1)'\r\n      }\r\n\r\n      /** 鼠标离开时恢复内部线条透明，但在拖拽过程中不执行 */\r\n      const handleMouseLeave = () => {\r\n        if (!isResizing) {\r\n          // outerLine保持透明，只设置内部线条的背景色\r\n          innerLine.style.backgroundColor = 'rgba(29, 98, 236, 0)'\r\n        }\r\n      }\r\n\r\n      /** 添加事件监听器 - 只在外部线条上添加，内部线条不再需要单独的事件监听 */\r\n      outerLine.addEventListener('mouseenter', handleMouseEnter)\r\n      outerLine.addEventListener('mouseleave', handleMouseLeave)\r\n\r\n      /** 存储事件监听器引用，以便后续移除 */\r\n      outerLine._mouseEnterListener = handleMouseEnter\r\n      outerLine._mouseLeaveListener = handleMouseLeave\r\n    }\r\n\r\n    /** 顶部拖拽线 */\r\n    if (edges.top) {\r\n      // 外部容器\r\n      const outerLine = document.createElement('div')\r\n      // 内部热区div\r\n      const innerLine = document.createElement('div')\r\n      \r\n      // 设置外部容器样式（热区放大）\r\n      Object.assign(outerLine.style, lineStyle, {\r\n        top: `-${hotZoneSize / 2 + margin}px`,\r\n        left: '0',\r\n        width: '100%',\r\n        height: `${hotZoneSize}px`,\r\n        cursor: 'row-resize',\r\n        zIndex: '10',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n      })\r\n      \r\n      // 设置内部线条样式（实际显示的线条）\r\n      Object.assign(innerLine.style, innerLineStyle, {\r\n        width: '100%',\r\n        height: '2px',\r\n      })\r\n      \r\n      // 将内部线条添加到外部容器\r\n      outerLine.appendChild(innerLine)\r\n      // 设置hover效果\r\n      setupHoverEffect(outerLine, innerLine)\r\n      // 添加到元素\r\n      element.appendChild(outerLine)\r\n      // 存储引用\r\n      resizeLines.set('top', outerLine)\r\n    }\r\n\r\n    /** 右侧拖拽线 */\r\n    if (edges.right) {\r\n      // 外部容器\r\n      const outerLine = document.createElement('div')\r\n      // 内部热区div\r\n      const innerLine = document.createElement('div')\r\n      \r\n      // 设置外部容器样式（热区放大）\r\n      Object.assign(outerLine.style, lineStyle, {\r\n        top: '0',\r\n        right: `-${hotZoneSize / 2 + margin}px`,\r\n        width: `${hotZoneSize}px`,\r\n        height: '100%',\r\n        cursor: 'col-resize',\r\n        zIndex: '10',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n      })\r\n      \r\n      // 设置内部线条样式（实际显示的线条）\r\n      Object.assign(innerLine.style, innerLineStyle, {\r\n        width: '2px',\r\n        height: '100%',\r\n      })\r\n      \r\n      // 将内部线条添加到外部容器\r\n      outerLine.appendChild(innerLine)\r\n      // 设置hover效果\r\n      setupHoverEffect(outerLine, innerLine)\r\n      // 添加到元素\r\n      element.appendChild(outerLine)\r\n      // 存储引用\r\n      resizeLines.set('right', outerLine)\r\n    }\r\n\r\n    /** 底部拖拽线 */\r\n    if (edges.bottom) {\r\n      // 外部容器\r\n      const outerLine = document.createElement('div')\r\n      // 内部热区div\r\n      const innerLine = document.createElement('div')\r\n      \r\n      // 设置外部容器样式（热区放大）\r\n      Object.assign(outerLine.style, lineStyle, {\r\n        bottom: `-${hotZoneSize / 2 + margin}px`,\r\n        left: '0',\r\n        width: '100%',\r\n        height: `${hotZoneSize}px`,\r\n        cursor: 'row-resize',\r\n        zIndex: '10',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n      })\r\n      \r\n      // 设置内部线条样式（实际显示的线条）\r\n      Object.assign(innerLine.style, innerLineStyle, {\r\n        width: '100%',\r\n        height: '2px',\r\n      })\r\n      \r\n      // 将内部线条添加到外部容器\r\n      outerLine.appendChild(innerLine)\r\n      // 设置hover效果\r\n      setupHoverEffect(outerLine, innerLine)\r\n      // 添加到元素\r\n      element.appendChild(outerLine)\r\n      // 存储引用\r\n      resizeLines.set('bottom', outerLine)\r\n    }\r\n\r\n    /** 左侧拖拽线 */\r\n    if (edges.left) {\r\n      // 外部容器\r\n      const outerLine = document.createElement('div')\r\n      // 内部热区div\r\n      const innerLine = document.createElement('div')\r\n      \r\n      // 设置外部容器样式（热区放大）\r\n      Object.assign(outerLine.style, lineStyle, {\r\n        top: '0',\r\n        left: `-${hotZoneSize / 2 + margin}px`,\r\n        width: `${hotZoneSize}px`,\r\n        height: '100%',\r\n        cursor: 'col-resize',\r\n        zIndex: '10',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n      })\r\n      \r\n      // 设置内部线条样式（实际显示的线条）\r\n      Object.assign(innerLine.style, innerLineStyle, {\r\n        width: '2px',\r\n        height: '100%',\r\n      })\r\n      \r\n      // 将内部线条添加到外部容器\r\n      outerLine.appendChild(innerLine)\r\n      // 设置hover效果\r\n      setupHoverEffect(outerLine, innerLine)\r\n      // 添加到元素\r\n      element.appendChild(outerLine)\r\n      // 存储引用\r\n      resizeLines.set('left', outerLine)\r\n    }\r\n  }\r\n\r\n  /** 设置拖拽线可见性 */\r\n  const setResizeLinesVisible = (_visible: boolean) => {\r\n    resizeLines.forEach(line => {\r\n      /** 始终保持pointerEvents为auto以支持hover效果 */\r\n      line.style.pointerEvents = 'auto'\r\n      line.style.display = 'flex' // 确保线条总是显示\r\n    })\r\n  }\r\n\r\n  /** 初始化interact实例 */\r\n  const interactable: Interactable = interact(element)\r\n    /** 设置元素样式 */\r\n    .styleCursor(false)\r\n\r\n  /** 配置拖拽功能 */\r\n  if (draggable) {\r\n    /** 定义拖拽事件处理函数 */\r\n    const handleDragStart = (_event: DragEvent) => {\r\n      /** 设置当前正在拖拽的状态 */\r\n      isDragging = true\r\n\r\n      // 禁用调整大小功能\r\n      if (resizable && resizeOptions) {\r\n        interactable.resizable(false)\r\n      }\r\n\r\n      callbacks?.onDrag?.({\r\n        type: 'dragstart',\r\n        top: cachedY,\r\n        left: cachedX,\r\n        deltaX: 0,\r\n        deltaY: 0,\r\n      })\r\n    }\r\n\r\n    const handleDragMove = (event: DragEvent) => {\r\n      // 更新缓存的坐标值\r\n      cachedX += event.dx\r\n      cachedY += event.dy\r\n\r\n      if (event.target instanceof HTMLElement) {\r\n        const computedStyle = getComputedStyle(event.target)\r\n        const isAbsoluteOrFixed = computedStyle.position === 'absolute' || computedStyle.position === 'fixed'\r\n\r\n        if (useCssTransforms && !isAbsoluteOrFixed) {\r\n          // 对于非绝对/固定定位元素，使用transform\r\n          event.target.style.transform = `translate(${cachedX}px, ${cachedY}px)`\r\n        } else if (isAbsoluteOrFixed) {\r\n          // 对于绝对/固定定位元素，使用直接定位\r\n          // 优先级：left > right, top > bottom\r\n          if (isLeftPositioned()) {\r\n            event.target.style.left = `${cachedX}px`\r\n          } else if (!isRightPositioned()) {\r\n            event.target.style.left = `${cachedX}px`\r\n          } else if (isRightPositioned()) {\r\n            event.target.style.right = `${-cachedX}px`\r\n          }\r\n          \r\n          if (isTopPositioned()) {\r\n            event.target.style.top = `${cachedY}px`\r\n          } else if (!isBottomPositioned()) {\r\n            event.target.style.top = `${cachedY}px`\r\n          } else if (isBottomPositioned()) {\r\n            event.target.style.bottom = `${-cachedY}px`\r\n          }\r\n        } else {\r\n          // 对于其他情况（如relative），使用transform\r\n          event.target.style.transform = `translate(${cachedX}px, ${cachedY}px)`\r\n        }\r\n      }\r\n\r\n      // 延迟更新数据属性，减少DOM操作频率\r\n      if (!event.target._dataUpdateTimer) {\r\n        event.target._dataUpdateTimer = setTimeout(() => {\r\n          if (event.target instanceof Element) {\r\n            event.target.setAttribute('data-x', cachedX.toString())\r\n            event.target.setAttribute('data-y', cachedY.toString())\r\n          }\r\n          delete event.target._dataUpdateTimer\r\n        }, 50)\r\n      }\r\n\r\n      // 如果有回调，使用requestAnimationFrame异态处理以提高性能\r\n      if (callbacks?.onDrag) {\r\n        requestAnimationFrame(() => {\r\n          callbacks.onDrag?.({\r\n            type: 'dragmove',\r\n            top: cachedY,\r\n            left: cachedX,\r\n            deltaX: event.dx,\r\n            deltaY: event.dy,\r\n          })\r\n        })\r\n      }\r\n    }\r\n\r\n    const handleDragEnd = (event: DragEvent) => {\r\n      // 重置拖拽状态\r\n      isDragging = false\r\n\r\n      // 重新启用调整大小功能\r\n      if (resizable && resizeOptions) {\r\n        interactable.resizable(true)\r\n      }\r\n\r\n      // 立即更新数据属性，确保最终状态正确\r\n      if (event.target instanceof Element) {\r\n        event.target.setAttribute('data-x', cachedX.toString())\r\n        event.target.setAttribute('data-y', cachedY.toString())\r\n      }\r\n\r\n      callbacks?.onDrag?.({\r\n        type: 'dragend',\r\n        top: cachedY,\r\n        left: cachedX,\r\n        deltaX: event.dx,\r\n        deltaY: event.dy,\r\n      })\r\n    }\r\n\r\n    // 创建节流版本的拖拽move处理函数\r\n    const throttleDragMove = throttle(\r\n      handleDragMove,\r\n      dragOptions?.threshold ?? DEFAULT_THROTTLE_DELAY,\r\n    )\r\n\r\n    // 创建拖拽配置\r\n    const draggableConfig: any = {\r\n      enabled: true,\r\n      allowFrom: dragOptions?.allowFrom,\r\n      ignoreFrom: dragOptions?.ignoreFrom,\r\n      modifiers: dragOptions?.modifiers || [],\r\n      listeners: {\r\n        start: handleDragStart,\r\n        move: throttleDragMove,\r\n        end: handleDragEnd,\r\n      },\r\n    }\r\n\r\n    // 添加额外支持的配置选项\r\n    if (dragOptions?.startAxis) draggableConfig.startAxis = dragOptions.startAxis\r\n    if (dragOptions?.lockAxis) draggableConfig.lockAxis = dragOptions.lockAxis\r\n    if (dragOptions?.max !== undefined) draggableConfig.max = dragOptions.max\r\n    if (dragOptions?.maxPerElement !== undefined)\r\n      draggableConfig.maxPerElement = dragOptions.maxPerElement\r\n\r\n    interactable.draggable(draggableConfig)\r\n  }\r\n\r\n  // 配置调整大小功能\r\n  if (resizable && resizeOptions) {\r\n    // 创建拖拽线\r\n    createResizeLines()\r\n\r\n    // 缓存最小/最大尺寸值，避免在每次resize move时重新计算\r\n    let cachedMinWidth = 10\r\n    let cachedMinHeight = 10\r\n    let cachedMaxWidth = Infinity\r\n    let cachedMaxHeight = Infinity\r\n    let cachedAspectRatio = cachedWidth / cachedHeight // 缓存宽高比\r\n\r\n    const handleResizeStart = (event: ResizeEvent) => {\r\n      // 显示拖拽线\r\n      setResizeLinesVisible(true)\r\n\r\n      // 设置当前正在调整大小的状态\r\n      isResizing = true\r\n\r\n      // 禁用拖拽功能\r\n      if (draggable && dragOptions) {\r\n        interactable.draggable(false)\r\n      }\r\n\r\n      // 标记活动边的hover状态\r\n      const normalizedEdges: Partial<ElementEdges> = {\r\n        top: Boolean(event.edges?.top),\r\n        right: Boolean(event.edges?.right),\r\n        bottom: Boolean(event.edges?.bottom),\r\n        left: Boolean(event.edges?.left),\r\n      }\r\n\r\n      // 应用活动边的样式\r\n      setEdgeActive(normalizedEdges)\r\n\r\n      // 预计算并缓存最小/最大尺寸值，只在resize开始时计算一次\r\n      cachedMinWidth = parseCssSize(resizeOptions?.minWidth ?? 10, event.target, 'width')\r\n      cachedMinHeight = parseCssSize(resizeOptions?.minHeight ?? 10, event.target, 'height')\r\n      cachedMaxWidth = parseCssSize(resizeOptions?.maxWidth ?? Infinity, event.target, 'width')\r\n      cachedMaxHeight = parseCssSize(resizeOptions?.maxHeight ?? Infinity, event.target, 'height')\r\n      cachedAspectRatio = cachedWidth / cachedHeight\r\n\r\n      // 如果有回调，使用requestAnimationFrame异态处理以提高性能\r\n      if (callbacks?.onResize) {\r\n        requestAnimationFrame(() => {\r\n          callbacks.onResize?.({\r\n            type: 'resizestart',\r\n            width: cachedWidth,\r\n            height: cachedHeight,\r\n            top: cachedY,\r\n            left: cachedX,\r\n            deltaWidth: 0,\r\n            deltaHeight: 0,\r\n            edges: normalizedEdges,\r\n          })\r\n        })\r\n      }\r\n    }\r\n\r\n    const handleResizeMove = (event: ResizeEvent) => {\r\n      // 动态检查元素的定位状态\r\n      const rightPositioned = isRightPositioned()\r\n      const leftPositioned = isLeftPositioned()\r\n      const topPositioned = isTopPositioned()\r\n      const bottomPositioned = isBottomPositioned()\r\n\r\n      // 对于drawer组件的固定定位场景，确保cached值在模式切换后正确初始化\r\n      // 检查元素是否有明确的固定定位属性设置\r\n      const computedStyle =\r\n        event.target instanceof HTMLElement ? getComputedStyle(event.target) : null\r\n\r\n      // 根据用户要求实现不同边缘调整时的位置计算\r\n      const deltaWidth = event.deltaRect?.width || 0\r\n      const deltaHeight = event.deltaRect?.height || 0\r\n\r\n      // 计算原始宽高比（如果需要保持宽高比）\r\n      let adjustedDeltaWidth = deltaWidth\r\n      let adjustedDeltaHeight = deltaHeight\r\n\r\n      // 如果启用了保持宽高比且不是固定定位元素\r\n      if (\r\n        resizeOptions?.preserveAspectRatio &&\r\n        !rightPositioned &&\r\n        !leftPositioned &&\r\n        !topPositioned &&\r\n        !bottomPositioned\r\n      ) {\r\n        // 使用缓存的宽高比\r\n        // 确定主要拖拽方向并调整另一维度\r\n        // 如果是水平边缘（左右），根据宽度变化调整高度\r\n        if (event.edges?.left || event.edges?.right) {\r\n          adjustedDeltaHeight = deltaWidth / cachedAspectRatio\r\n        } else if (event.edges?.top || event.edges?.bottom) {\r\n          // 如果是垂直边缘（上下），根据高度变化调整宽度\r\n          adjustedDeltaWidth = deltaHeight * cachedAspectRatio\r\n        }\r\n      }\r\n\r\n      // 计算目标尺寸，使用缓存的限制值\r\n      let targetWidth = cachedWidth + adjustedDeltaWidth\r\n      let targetHeight = cachedHeight + adjustedDeltaHeight\r\n\r\n      // 应用最小最大限制\r\n      targetWidth = Math.max(cachedMinWidth, Math.min(cachedMaxWidth, targetWidth))\r\n      targetHeight = Math.max(cachedMinHeight, Math.min(cachedMaxHeight, targetHeight))\r\n\r\n      // 重新计算实际的delta值\r\n      adjustedDeltaWidth = targetWidth - cachedWidth\r\n      adjustedDeltaHeight = targetHeight - cachedHeight\r\n\r\n      // 避免不必要的计算和更新\r\n      if (adjustedDeltaWidth === 0 && adjustedDeltaHeight === 0) {\r\n        return // 没有变化，直接返回\r\n      }\r\n\r\n      // 在应用尺寸限制后，根据实际的delta值调整位置\r\n      // 对于固定定位元素，我们避免调整cached值，而是直接通过CSS属性控制位置\r\n      // 这样可以确保固定点不变，避免尺寸变化跳跃\r\n\r\n      // 对于固定定位元素，在模式切换后首次resize时重置cached值\r\n      // 确保尺寸计算基于实际的DOM状态而不是缓存值\r\n      if (\r\n        (rightPositioned || leftPositioned || topPositioned || bottomPositioned) &&\r\n        computedStyle\r\n      ) {\r\n        // 重新获取元素的实际尺寸，避免模式切换后缓存值不准确\r\n        const currentRect = event.target.getBoundingClientRect()\r\n        if (\r\n          Math.abs(currentRect.width - cachedWidth) > 1 ||\r\n          Math.abs(currentRect.height - cachedHeight) > 1\r\n        ) {\r\n          cachedWidth = currentRect.width\r\n          cachedHeight = currentRect.height\r\n        }\r\n      }\r\n\r\n      // 只对非固定定位元素调整cached值\r\n      if (!rightPositioned && !leftPositioned && !topPositioned && !bottomPositioned) {\r\n        // 1. resize上边时\r\n        if (event.edges?.top) {\r\n          cachedY -= adjustedDeltaHeight\r\n        }\r\n        // 2. resize右边时\r\n        if (event.edges?.right) {\r\n          // 不调整cachedX，因为resize右边不影响位置\r\n        }\r\n        // 3. resize下边时\r\n        if (event.edges?.bottom) {\r\n          // 不调整cachedY，因为resize下边不影响位置\r\n        }\r\n        // 4. resize左边时\r\n        if (event.edges?.left) {\r\n          cachedX -= adjustedDeltaWidth\r\n        }\r\n      }\r\n\r\n      // 更新尺寸缓存\r\n      cachedWidth = targetWidth\r\n      cachedHeight = targetHeight\r\n\r\n      // 优化DOM操作，支持多种resize方向\r\n\r\n      // 对于所有元素，首先更新宽度\r\n      if (event.edges?.left || event.edges?.right) {\r\n        event.target.style.width = `${cachedWidth}px`\r\n      }\r\n\r\n      // 对于所有元素，首先更新高度\r\n      if (event.edges?.top || event.edges?.bottom) {\r\n        event.target.style.height = `${cachedHeight}px`\r\n      }\r\n\r\n      // 对于固定定位元素，需要额外调整位置以保持固定点不变\r\n      // 这些调整会在下面的特殊处理部分完成\r\n\r\n      // 针对底部固定元素拖动上边的特殊处理\r\n      if (event.edges?.top && bottomPositioned) {\r\n        // 底部固定时，拖动上边需要计算新的top位置\r\n        // 获取父容器高度\r\n        const parentRect = event.target.parentElement?.getBoundingClientRect()\r\n        if (parentRect) {\r\n          // 对于底部固定元素，top应该是：父容器高度 - 元素高度 - bottom定位值\r\n          const bottomValue = parseInt(getComputedStyle(event.target).bottom || '0', 10)\r\n          const newTop = parentRect.height - cachedHeight - bottomValue\r\n          event.target.style.top = `${newTop}px`\r\n        }\r\n      }\r\n\r\n      // 针对右侧固定元素拖动左边的特殊处理\r\n      if (event.edges?.left && rightPositioned) {\r\n        // 右侧固定时，拖动左边需要计算新的left位置\r\n        // 获取父容器宽度\r\n        const parentRect = event.target.parentElement?.getBoundingClientRect()\r\n        if (parentRect) {\r\n          // 对于右侧固定元素，left应该是：父容器宽度 - 元素宽度 - right定位值\r\n          const rightValue = parseInt(getComputedStyle(event.target).right || '0', 10)\r\n          const newLeft = parentRect.width - cachedWidth - rightValue\r\n          event.target.style.left = `${newLeft}px`\r\n        }\r\n      }\r\n\r\n      // 针对左侧固定元素拖动右边的特殊处理\r\n      if (event.edges?.right && leftPositioned) {\r\n        // 左侧固定时，拖动右边需要确保宽度变化平滑\r\n        // 获取父容器宽度和当前left值\r\n        const leftValue = parseInt(getComputedStyle(event.target).left || '0', 10)\r\n        // 直接设置width属性，由于left已经固定，这会自动保持左侧固定点不变\r\n        // 为了确保模式切换后的平滑性，显式设置left值\r\n        event.target.style.left = `${leftValue}px`\r\n      }\r\n\r\n      // 针对顶部固定元素拖动下边的特殊处理\r\n      if (event.edges?.bottom && topPositioned) {\r\n        // 顶部固定时，拖动下边需要确保高度变化平滑\r\n        // 获取当前top值\r\n        const topValue = parseInt(getComputedStyle(event.target).top || '0', 10)\r\n        // 直接设置height属性，由于top已经固定，这会自动保持顶部固定点不变\r\n        // 为了确保模式切换后的平滑性，显式设置top值\r\n        event.target.style.top = `${topValue}px`\r\n      }\r\n\r\n      // 对于非固定定位元素且使用transform的情况，更新位置\r\n      if (\r\n        !rightPositioned &&\r\n        !leftPositioned &&\r\n        !topPositioned &&\r\n        !bottomPositioned &&\r\n        useCssTransforms\r\n      ) {\r\n        event.target.style.transform = `translate(${cachedX}px, ${cachedY}px)`\r\n      }\r\n\r\n      // 完全移除data属性的更新，这些属性在resize过程中不是必需的，只在结束时更新\r\n      // 减少DOM操作以提高性能\r\n\r\n      // 转换 edges 类型\r\n      const normalizedEdges: Partial<ElementEdges> = {\r\n        top: Boolean(event.edges?.top),\r\n        right: Boolean(event.edges?.right),\r\n        bottom: Boolean(event.edges?.bottom),\r\n        left: Boolean(event.edges?.left),\r\n      }\r\n\r\n      // 如果有回调，使用requestAnimationFrame异态处理以提高性能\r\n      if (callbacks?.onResize) {\r\n        requestAnimationFrame(() => {\r\n          callbacks.onResize?.({\r\n            type: 'resizemove',\r\n            width: cachedWidth,\r\n            height: cachedHeight,\r\n            top: cachedY,\r\n            left: cachedX,\r\n            deltaWidth: deltaWidth,\r\n            deltaHeight: deltaHeight,\r\n            edges: normalizedEdges,\r\n          })\r\n        })\r\n      }\r\n    }\r\n\r\n    const handleResizeEnd = (event: ResizeEvent) => {\r\n      // 移除正在调整大小的状态\r\n      isResizing = false\r\n\r\n      // 重新启用拖拽功能\r\n      if (draggable && dragOptions) {\r\n        interactable.draggable(true)\r\n      }\r\n\r\n      // 重置拖拽边状态\r\n      resetEdgesActive()\r\n\r\n      // 不再需要清除动画帧，因为resize处理函数不再使用requestAnimationFrame包装\r\n\r\n      // 立即更新数据属性，确保最终状态正确\r\n      if (event.target instanceof Element) {\r\n        event.target.setAttribute('data-x', cachedX.toString())\r\n        event.target.setAttribute('data-y', cachedY.toString())\r\n        event.target.setAttribute('data-width', cachedWidth.toString())\r\n        event.target.setAttribute('data-height', cachedHeight.toString())\r\n      }\r\n\r\n      // 转换 edges 类型\r\n      const normalizedEdges: Partial<ElementEdges> = {\r\n        top: Boolean(event.edges?.top),\r\n        right: Boolean(event.edges?.right),\r\n        bottom: Boolean(event.edges?.bottom),\r\n        left: Boolean(event.edges?.left),\r\n      }\r\n\r\n      // 使用requestAnimationFrame确保回调在DOM更新后执行\r\n      requestAnimationFrame(() => {\r\n        callbacks?.onResize?.({\r\n          type: 'resizeend',\r\n          width: cachedWidth,\r\n          height: cachedHeight,\r\n          top: cachedY,\r\n          left: cachedX,\r\n          deltaWidth: event.deltaRect?.width || 0,\r\n          deltaHeight: event.deltaRect?.height || 0,\r\n          edges: normalizedEdges,\r\n        })\r\n      })\r\n    }\r\n\r\n    // 直接使用handleResizeMove，移除多余的动画帧包装，减少函数调用栈\r\n    const rafResizeMove = handleResizeMove\r\n\r\n    // 完全移除节流，直接处理所有resize事件以获得最佳响应性\r\n    const throttleResizeMove = rafResizeMove\r\n\r\n    // 创建调整大小配置\r\n    const resizableConfig: any = {\r\n      enabled: true,\r\n      edges: resizeOptions?.edges || {},\r\n      modifiers: resizeOptions?.modifiers || [],\r\n      listeners: {\r\n        start: handleResizeStart,\r\n        move: throttleResizeMove,\r\n        end: handleResizeEnd,\r\n      },\r\n    }\r\n\r\n    // 添加额外支持的配置选项\r\n    if (resizeOptions?.square !== undefined) resizableConfig.square = resizeOptions.square\r\n    if (resizeOptions?.preserveAspectRatio !== undefined)\r\n      resizableConfig.preserveAspectRatio = resizeOptions.preserveAspectRatio\r\n    if (resizeOptions?.invert) resizableConfig.invert = resizeOptions.invert\r\n    if (resizeOptions?.margin !== undefined) resizableConfig.margin = resizeOptions.margin\r\n    if (resizeOptions?.max !== undefined) resizableConfig.max = resizeOptions.max\r\n    if (resizeOptions?.maxPerElement !== undefined)\r\n      resizableConfig.maxPerElement = resizeOptions.maxPerElement\r\n    if (resizeOptions?.minWidth !== undefined)\r\n      resizableConfig.minWidth = parseCssSize(resizeOptions.minWidth, element, 'width')\r\n    if (resizeOptions?.minHeight !== undefined)\r\n      resizableConfig.minHeight = parseCssSize(resizeOptions.minHeight, element, 'height')\r\n    if (resizeOptions?.maxWidth !== undefined)\r\n      resizableConfig.maxWidth = parseCssSize(resizeOptions.maxWidth, element, 'width')\r\n    if (resizeOptions?.maxHeight !== undefined)\r\n      resizableConfig.maxHeight = parseCssSize(resizeOptions.maxHeight, element, 'height')\r\n\r\n    try {\r\n      interactable.resizable(resizableConfig)\r\n    } catch (error) {\r\n      console.error('Error setting up resizable:', error)\r\n    }\r\n  }\r\n\r\n  // 初始化样式\r\n  if (element instanceof HTMLElement) {\r\n    // 移除任何可能存在的transition效果，避免与resize冲突\r\n    element.style.transition = 'none'\r\n    \r\n    // 设置初始宽度和高度\r\n    element.style.width = `${cachedWidth}px`\r\n    element.style.height = `${cachedHeight}px`\r\n  }\r\n\r\n  // 初始化transform样式\r\n  if (element instanceof HTMLElement) {\r\n    const computedStyle = getComputedStyle(element)\r\n    \r\n    // 检查元素是否使用绝对定位或固定定位\r\n    const isAbsoluteOrFixed = computedStyle.position === 'absolute' || computedStyle.position === 'fixed'\r\n    \r\n    if (useCssTransforms && !isAbsoluteOrFixed) {\r\n      // 对于非绝对/固定定位元素（如relative或static），使用transform\r\n      element.style.transform = `translate(${cachedX}px, ${cachedY}px)`\r\n    } else if (isAbsoluteOrFixed) {\r\n      // 对于绝对/固定定位元素，使用直接定位\r\n      if (!isRightPositioned() && !isLeftPositioned()) {\r\n        element.style.left = `${cachedX}px`\r\n      }\r\n      if (!isTopPositioned() && !isBottomPositioned()) {\r\n        element.style.top = `${cachedY}px`\r\n      }\r\n    } else {\r\n      // 对于其他情况（如relative），优先使用transform\r\n      element.style.transform = `translate(${cachedX}px, ${cachedY}px)`\r\n    }\r\n  }\r\n\r\n  // 更新位置的方法\r\n  const updatePosition = (newX: number | string, newY: number | string) => {\r\n    // 将传入值解析为像素用于内部计算\r\n    cachedX = parsePositionValue(newX, element, 'x')\r\n    cachedY = parsePositionValue(newY, element, 'y')\r\n\r\n    // 更新DOM元素的位置\r\n    if (element instanceof HTMLElement) {\r\n      const computedStyle = getComputedStyle(element)\r\n      const isAbsoluteOrFixed = computedStyle.position === 'absolute' || computedStyle.position === 'fixed'\r\n      const setLeft = (val: number | string) => {\r\n        if (typeof val === 'string' && isCssUnitValue(val) && isAbsoluteOrFixed) {\r\n          element.style.left = val\r\n        } else {\r\n          element.style.left = `${cachedX}px`\r\n        }\r\n      }\r\n      const setTop = (val: number | string) => {\r\n        if (typeof val === 'string' && isCssUnitValue(val) && isAbsoluteOrFixed) {\r\n          element.style.top = val\r\n        } else {\r\n          element.style.top = `${cachedY}px`\r\n        }\r\n      }\r\n      if (useCssTransforms && !isAbsoluteOrFixed) {\r\n        // transform只能使用像素值\r\n        element.style.transform = `translate(${cachedX}px, ${cachedY}px)`\r\n      } else if (isAbsoluteOrFixed) {\r\n        element.style.right = ''\r\n        element.style.bottom = ''\r\n        \r\n        // 无论是否已设置left/top，都强制更新位置\r\n        setLeft(newX)\r\n        setTop(newY)\r\n      } else {\r\n        element.style.transform = `translate(${cachedX}px, ${cachedY}px)`\r\n      }\r\n    }\r\n\r\n    // 更新数据属性 (保持原始值, 以便再次解析)\r\n    if (element instanceof Element) {\r\n      element.setAttribute('data-x', typeof newX === 'string' ? newX : cachedX.toString())\r\n      element.setAttribute('data-y', typeof newY === 'string' ? newY : cachedY.toString())\r\n    }\r\n  }\r\n\r\n  // 更新尺寸的方法\r\n  const updateSize = (newWidth: number | string, newHeight: number | string) => {\r\n    cachedWidth = typeof newWidth === 'number' ? newWidth : parseCssSize(newWidth, element, 'width')\r\n    cachedHeight = typeof newHeight === 'number' ? newHeight : parseCssSize(newHeight, element, 'height')\r\n\r\n    if (element instanceof HTMLElement) {\r\n      const setWidth = (val: number | string) => {\r\n        if (typeof val === 'string' && isCssUnitValue(val)) {\r\n          element.style.width = val\r\n        } else {\r\n          element.style.width = `${cachedWidth}px`\r\n        }\r\n      }\r\n      const setHeight = (val: number | string) => {\r\n        if (typeof val === 'string' && isCssUnitValue(val)) {\r\n          element.style.height = val\r\n        } else {\r\n          element.style.height = `${cachedHeight}px`\r\n        }\r\n      }\r\n      setWidth(newWidth)\r\n      setHeight(newHeight)\r\n    }\r\n\r\n    if (element instanceof Element) {\r\n      element.setAttribute('data-width', typeof newWidth === 'string' ? newWidth : cachedWidth.toString())\r\n      element.setAttribute('data-height', typeof newHeight === 'string' ? newHeight : cachedHeight.toString())\r\n    }\r\n  }\r\n\r\n  // 更新位置和大小的方法（组合方法）\r\n  const updatePositionAndSize = (newX: number | string, newY: number | string, newWidth: number | string, newHeight: number | string) => {\r\n    updatePosition(newX, newY)\r\n    updateSize(newWidth, newHeight)\r\n  }\r\n\r\n  // 返回清理函数和更新方法\r\n  return {\r\n    cleanup: () => {\r\n      // 移除拖拽线\r\n      resizeLines.forEach(line => {\r\n        // 移除事件监听器\r\n        if (line._mouseEnterListener) {\r\n          line.removeEventListener('mouseenter', line._mouseEnterListener)\r\n        }\r\n        if (line._mouseLeaveListener) {\r\n          line.removeEventListener('mouseleave', line._mouseLeaveListener)\r\n        }\r\n        // 移除DOM元素\r\n        line.remove()\r\n      })\r\n\r\n      // 清理interact实例\r\n      try {\r\n        interactable.unset()\r\n      } catch (error) {\r\n        console.error('Error unsetting interactable:', error)\r\n      }\r\n    },\r\n    updatePositionAndSize,\r\n    updatePosition,\r\n    updateSize,\r\n  }\r\n}\r\n"],"names":["DEFAULT_THROTTLE_DELAY","makeElementDraggableResizable","element","options","callbacks","mergedOptions","draggable","resizable","useCssTransforms","dragOptions","resizeOptions","getData","key","defaultValue","setData","value","rect","width","height","initialX","initialY","initialWidth","initialHeight","cachedX","parsePositionValue","cachedY","cachedWidth","parseCssSize","cachedHeight","resizeLines","isResizing","isPositioned","property","computedStyle","isRightPositioned","isLeftPositioned","isTopPositioned","isBottomPositioned","setEdgeActive","edges","edge","line","innerLine","resetEdgesActive","createResizeLines","margin","hotZoneSize","lineStyle","innerLineStyle","setupHoverEffect","outerLine","handleMouseEnter","handleMouseLeave","setResizeLinesVisible","_visible","interactable","interact","handleDragStart","_event","_a","handleDragMove","event","isAbsoluteOrFixed","handleDragEnd","throttleDragMove","throttle","draggableConfig","cachedMinWidth","cachedMinHeight","cachedMaxWidth","cachedMaxHeight","cachedAspectRatio","handleResizeStart","normalizedEdges","_b","_c","_d","handleResizeMove","rightPositioned","leftPositioned","topPositioned","bottomPositioned","deltaWidth","deltaHeight","adjustedDeltaWidth","adjustedDeltaHeight","_e","_f","targetWidth","targetHeight","currentRect","_g","_h","_i","_j","_k","_l","_m","_n","_o","parentRect","_p","bottomValue","newTop","_q","_r","rightValue","newLeft","_s","leftValue","_t","topValue","_u","_v","_w","_x","handleResizeEnd","throttleResizeMove","resizableConfig","error","updatePosition","newX","newY","setLeft","val","isCssUnitValue","setTop","updateSize","newWidth","newHeight","setWidth","setHeight"],"mappings":";;;AAsBA,MAAMA,KAAyB;AA6KxB,SAASC,GACdC,GACAC,KAAoC,CAAA,GACpCC,GAC0B;AAmB1B,QAAMC,IAAgB,EAAE,GAjByB;AAAA,IAC/C,WAAW;AAAA,IACX,WAAW;AAAA,IACX,kBAAkB;AAAA,IAClB,aAAa,CAAC;AAAA,IACd,eAAe;AAAA,MACb,OAAO,EAAE,KAAK,IAAO,OAAO,IAAO,QAAQ,IAAO,MAAM,GAAM;AAAA,MAC9D,QAAQ;AAAA,MACR,aAAa;AAAA,IACf;AAAA,IACA,GAAG;AAAA,IACH,GAAG;AAAA,IACH,OAAO;AAAA,IACP,QAAQ;AAAA,EACV,GAG2C,GAAGF,GAAQ,GAChD,EAAE,WAAAG,GAAW,WAAAC,GAAW,kBAAAC,GAAkB,aAAAC,GAAa,eAAAC,MAAkBL,GAGzEM,IAAU,CAACC,GAAaC,MACrBX,EAAQ,aAAa,QAAQU,CAAG,EAAE,KAAKC,GAE1CC,IAAU,CAACF,GAAaG,MAA2B;AACvD,IAAAb,EAAQ,aAAa,QAAQU,CAAG,IAAIG,EAAM,UAAU;AAAA,EACtD,GAGMC,IAAOd,EAAQ,sBAAsB,GACrCe,IAAQZ,EAAc,SAASW,EAAK,SAAS,GAC7CE,IAASb,EAAc,UAAUW,EAAK,UAAU;AAG9C,EAAAF,EAAA,KAAKT,EAAc,KAAK,CAAC,GACzBS,EAAA,KAAKT,EAAc,KAAK,CAAC,GACzBS,EAAA,SAASG,EAAM,UAAU,GACzBH,EAAA,UAAUI,EAAO,UAAU;AAE7B,QAAAC,KAAWR,EAAQ,KAAK,GAAG,GAC3BS,KAAWT,EAAQ,KAAK,GAAG,GAC3BU,KAAeV,EAAQ,SAASM,EAAM,UAAU,GAChDK,KAAgBX,EAAQ,UAAUO,EAAO,UAAU;AAGzD,MAAIK,IAAUC,EAAmBL,IAAUjB,GAAS,GAAG,GACnDuB,IAAUD,EAAmBJ,IAAUlB,GAAS,GAAG,GACnDwB,IAAcC,EAAaN,IAAcnB,GAAS,OAAO,GACzD0B,IAAeD,EAAaL,IAAepB,GAAS,QAAQ;AAG1D,QAAA2B,wBAAkB,IAAyB;AAKjD,MAAIC,IAAa;AAKX,QAAAC,IAAe,CAACC,MAAkD;AACtE,QAAI9B,aAAmB,aAAa;AAC5B,YAAA+B,IAAgB,iBAAiB/B,CAAO;AAE9C,cAAQ+B,EAAc,aAAa,cAAcA,EAAc,aAAa,YACrEA,EAAcD,CAAQ,MAAM,UAAUC,EAAcD,CAAQ,MAAM;AAAA,IAAA;AAEpE,WAAA;AAAA,EACT,GAGME,IAAoB,MAAMH,EAAa,OAAO,GAG9CI,IAAmB,MAAMJ,EAAa,MAAM,GAG5CK,IAAkB,MAAML,EAAa,KAAK,GAG1CM,IAAqB,MAAMN,EAAa,QAAQ,GAMhDO,KAAgB,CAACC,MAAiC;AAEpD,KAAC,OAAO,SAAS,UAAU,MAAM,EAAY,QAAQ,CAAQC,MAAA;AACvD,YAAAC,IAAOZ,EAAY,IAAIW,CAAI;AACjC,UAAIC,GAAM;AAER,cAAMC,IAAYD,EAAK;AACvB,QAAIC,MACFA,EAAU,MAAM,kBAAkBH,EAAMC,CAAI,IAAI,yBAAyB;AAAA,MAC3E;AAAA,IACF,CACD;AAAA,EACH,GAGMG,KAAmB,MAAM;AAC7B,IAAAd,EAAY,QAAQ,CAAQY,MAAA;AAE1B,YAAMC,IAAYD,EAAK;AACvB,MAAIC,MACFA,EAAU,MAAM,kBAAkB;AAAA,IACpC,CACD;AAAA,EAEH,GAEME,KAAoB,MAAM;AACxB,UAAAL,KAAQ7B,KAAA,gBAAAA,EAAe,UAAS,CAAC,GAEjCmC,KAASnC,KAAA,gBAAAA,EAAe,WAAU,GAElCoC,KAAcpC,KAAA,gBAAAA,EAAe,gBAAe,IAE5CqC,IAAY;AAAA,MAChB,UAAU;AAAA,MACV,iBAAiB;AAAA;AAAA,MACjB,eAAe;AAAA;AAAA;AAAA,MAEf,SAAS;AAAA,MACT,YAAY;AAAA,MACZ,gBAAgB;AAAA,IAClB,GAGMC,IAAiB;AAAA,MACrB,iBAAiB;AAAA;AAAA,MACjB,YAAY;AAAA,MACZ,eAAe;AAAA,IACjB,GAGMC,IAAmB,CAACC,GAAwBR,MAA2B;AAE3E,YAAMS,IAAmB,MAAM;AAE7B,QAAAT,EAAU,MAAM,kBAAkB;AAAA,MACpC,GAGMU,IAAmB,MAAM;AAC7B,QAAKtB,MAEHY,EAAU,MAAM,kBAAkB;AAAA,MAEtC;AAGU,MAAAQ,EAAA,iBAAiB,cAAcC,CAAgB,GAC/CD,EAAA,iBAAiB,cAAcE,CAAgB,GAGzDF,EAAU,sBAAsBC,GAChCD,EAAU,sBAAsBE;AAAA,IAClC;AAGA,QAAIb,EAAM,KAAK;AAEP,YAAAW,IAAY,SAAS,cAAc,KAAK,GAExCR,IAAY,SAAS,cAAc,KAAK;AAGvC,aAAA,OAAOQ,EAAU,OAAOH,GAAW;AAAA,QACxC,KAAK,IAAID,IAAc,IAAID,CAAM;AAAA,QACjC,MAAM;AAAA,QACN,OAAO;AAAA,QACP,QAAQ,GAAGC,CAAW;AAAA,QACtB,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,YAAY;AAAA,QACZ,gBAAgB;AAAA,MAAA,CACjB,GAGM,OAAA,OAAOJ,EAAU,OAAOM,GAAgB;AAAA,QAC7C,OAAO;AAAA,QACP,QAAQ;AAAA,MAAA,CACT,GAGDE,EAAU,YAAYR,CAAS,GAE/BO,EAAiBC,GAAWR,CAAS,GAErCxC,EAAQ,YAAYgD,CAAS,GAEjBrB,EAAA,IAAI,OAAOqB,CAAS;AAAA,IAAA;AAIlC,QAAIX,EAAM,OAAO;AAET,YAAAW,IAAY,SAAS,cAAc,KAAK,GAExCR,IAAY,SAAS,cAAc,KAAK;AAGvC,aAAA,OAAOQ,EAAU,OAAOH,GAAW;AAAA,QACxC,KAAK;AAAA,QACL,OAAO,IAAID,IAAc,IAAID,CAAM;AAAA,QACnC,OAAO,GAAGC,CAAW;AAAA,QACrB,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,YAAY;AAAA,QACZ,gBAAgB;AAAA,MAAA,CACjB,GAGM,OAAA,OAAOJ,EAAU,OAAOM,GAAgB;AAAA,QAC7C,OAAO;AAAA,QACP,QAAQ;AAAA,MAAA,CACT,GAGDE,EAAU,YAAYR,CAAS,GAE/BO,EAAiBC,GAAWR,CAAS,GAErCxC,EAAQ,YAAYgD,CAAS,GAEjBrB,EAAA,IAAI,SAASqB,CAAS;AAAA,IAAA;AAIpC,QAAIX,EAAM,QAAQ;AAEV,YAAAW,IAAY,SAAS,cAAc,KAAK,GAExCR,IAAY,SAAS,cAAc,KAAK;AAGvC,aAAA,OAAOQ,EAAU,OAAOH,GAAW;AAAA,QACxC,QAAQ,IAAID,IAAc,IAAID,CAAM;AAAA,QACpC,MAAM;AAAA,QACN,OAAO;AAAA,QACP,QAAQ,GAAGC,CAAW;AAAA,QACtB,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,YAAY;AAAA,QACZ,gBAAgB;AAAA,MAAA,CACjB,GAGM,OAAA,OAAOJ,EAAU,OAAOM,GAAgB;AAAA,QAC7C,OAAO;AAAA,QACP,QAAQ;AAAA,MAAA,CACT,GAGDE,EAAU,YAAYR,CAAS,GAE/BO,EAAiBC,GAAWR,CAAS,GAErCxC,EAAQ,YAAYgD,CAAS,GAEjBrB,EAAA,IAAI,UAAUqB,CAAS;AAAA,IAAA;AAIrC,QAAIX,EAAM,MAAM;AAER,YAAAW,IAAY,SAAS,cAAc,KAAK,GAExCR,IAAY,SAAS,cAAc,KAAK;AAGvC,aAAA,OAAOQ,EAAU,OAAOH,GAAW;AAAA,QACxC,KAAK;AAAA,QACL,MAAM,IAAID,IAAc,IAAID,CAAM;AAAA,QAClC,OAAO,GAAGC,CAAW;AAAA,QACrB,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,YAAY;AAAA,QACZ,gBAAgB;AAAA,MAAA,CACjB,GAGM,OAAA,OAAOJ,EAAU,OAAOM,GAAgB;AAAA,QAC7C,OAAO;AAAA,QACP,QAAQ;AAAA,MAAA,CACT,GAGDE,EAAU,YAAYR,CAAS,GAE/BO,EAAiBC,GAAWR,CAAS,GAErCxC,EAAQ,YAAYgD,CAAS,GAEjBrB,EAAA,IAAI,QAAQqB,CAAS;AAAA,IAAA;AAAA,EAErC,GAGMG,KAAwB,CAACC,MAAsB;AACnD,IAAAzB,EAAY,QAAQ,CAAQY,MAAA;AAE1B,MAAAA,EAAK,MAAM,gBAAgB,QAC3BA,EAAK,MAAM,UAAU;AAAA,IAAA,CACtB;AAAA,EACH,GAGMc,IAA6BC,GAAStD,CAAO,EAEhD,YAAY,EAAK;AAGpB,MAAII,GAAW;AAEP,UAAAmD,IAAkB,CAACC,MAAsB;;AAK7C,MAAInD,KAAaG,KACf6C,EAAa,UAAU,EAAK,IAG9BI,IAAAvD,KAAA,gBAAAA,EAAW,WAAX,QAAAuD,EAAA,KAAAvD,GAAoB;AAAA,QAClB,MAAM;AAAA,QACN,KAAKqB;AAAA,QACL,MAAMF;AAAA,QACN,QAAQ;AAAA,QACR,QAAQ;AAAA,MAAA;AAAA,IAEZ,GAEMqC,IAAiB,CAACC,MAAqB;AAKvC,UAHJtC,KAAWsC,EAAM,IACjBpC,KAAWoC,EAAM,IAEbA,EAAM,kBAAkB,aAAa;AACjC,cAAA5B,IAAgB,iBAAiB4B,EAAM,MAAM,GAC7CC,IAAoB7B,EAAc,aAAa,cAAcA,EAAc,aAAa;AAE1F,QAAAzB,KAAoB,CAACsD,IAEvBD,EAAM,OAAO,MAAM,YAAY,aAAatC,CAAO,OAAOE,CAAO,QACxDqC,KAGL3B,MACF0B,EAAM,OAAO,MAAM,OAAO,GAAGtC,CAAO,OAC1BW,MAEDA,QACT2B,EAAM,OAAO,MAAM,QAAQ,GAAG,CAACtC,CAAO,QAFtCsC,EAAM,OAAO,MAAM,OAAO,GAAGtC,CAAO,MAKlCa,MACFyB,EAAM,OAAO,MAAM,MAAM,GAAGpC,CAAO,OACzBY,MAEDA,QACTwB,EAAM,OAAO,MAAM,SAAS,GAAG,CAACpC,CAAO,QAFvCoC,EAAM,OAAO,MAAM,MAAM,GAAGpC,CAAO,QAMrCoC,EAAM,OAAO,MAAM,YAAY,aAAatC,CAAO,OAAOE,CAAO;AAAA,MACnE;AAIE,MAACoC,EAAM,OAAO,qBACVA,EAAA,OAAO,mBAAmB,WAAW,MAAM;AAC3C,QAAAA,EAAM,kBAAkB,YAC1BA,EAAM,OAAO,aAAa,UAAUtC,EAAQ,UAAU,GACtDsC,EAAM,OAAO,aAAa,UAAUpC,EAAQ,UAAU,IAExD,OAAOoC,EAAM,OAAO;AAAA,SACnB,EAAE,IAIHzD,KAAA,QAAAA,EAAW,UACb,sBAAsB,MAAM;;AAC1B,SAAAuD,IAAAvD,EAAU,WAAV,QAAAuD,EAAA,KAAAvD,GAAmB;AAAA,UACjB,MAAM;AAAA,UACN,KAAKqB;AAAA,UACL,MAAMF;AAAA,UACN,QAAQsC,EAAM;AAAA,UACd,QAAQA,EAAM;AAAA,QAAA;AAAA,MACf,CACF;AAAA,IAEL,GAEME,IAAgB,CAACF,MAAqB;;AAK1C,MAAItD,KAAaG,KACf6C,EAAa,UAAU,EAAI,GAIzBM,EAAM,kBAAkB,YAC1BA,EAAM,OAAO,aAAa,UAAUtC,EAAQ,UAAU,GACtDsC,EAAM,OAAO,aAAa,UAAUpC,EAAQ,UAAU,KAGxDkC,IAAAvD,KAAA,gBAAAA,EAAW,WAAX,QAAAuD,EAAA,KAAAvD,GAAoB;AAAA,QAClB,MAAM;AAAA,QACN,KAAKqB;AAAA,QACL,MAAMF;AAAA,QACN,QAAQsC,EAAM;AAAA,QACd,QAAQA,EAAM;AAAA,MAAA;AAAA,IAElB,GAGMG,IAAmBC;AAAA,MACvBL;AAAA,OACAnD,KAAA,gBAAAA,EAAa,cAAaT;AAAA,IAC5B,GAGMkE,IAAuB;AAAA,MAC3B,SAAS;AAAA,MACT,WAAWzD,KAAA,gBAAAA,EAAa;AAAA,MACxB,YAAYA,KAAA,gBAAAA,EAAa;AAAA,MACzB,YAAWA,KAAA,gBAAAA,EAAa,cAAa,CAAC;AAAA,MACtC,WAAW;AAAA,QACT,OAAOgD;AAAA,QACP,MAAMO;AAAA,QACN,KAAKD;AAAA,MAAA;AAAA,IAET;AAGA,IAAItD,KAAA,QAAAA,EAAa,cAA2ByD,EAAA,YAAYzD,EAAY,YAChEA,KAAA,QAAAA,EAAa,aAA0ByD,EAAA,WAAWzD,EAAY,YAC9DA,KAAA,gBAAAA,EAAa,SAAQ,WAAWyD,EAAgB,MAAMzD,EAAY,OAClEA,KAAA,gBAAAA,EAAa,mBAAkB,WACjCyD,EAAgB,gBAAgBzD,EAAY,gBAE9C8C,EAAa,UAAUW,CAAe;AAAA,EAAA;AAIxC,MAAI3D,KAAaG,GAAe;AAEZ,IAAAkC,GAAA;AAGlB,QAAIuB,IAAiB,IACjBC,IAAkB,IAClBC,IAAiB,OACjBC,IAAkB,OAClBC,IAAoB7C,IAAcE;AAEhC,UAAA4C,IAAoB,CAACX,MAAuB;;AAEhD,MAAAR,GAA0B,GAGbvB,IAAA,IAGTxB,KAAaG,KACf8C,EAAa,UAAU,EAAK;AAI9B,YAAMkB,IAAyC;AAAA,QAC7C,KAAK,IAAQd,IAAAE,EAAM,UAAN,QAAAF,EAAa;AAAA,QAC1B,OAAO,IAAQe,IAAAb,EAAM,UAAN,QAAAa,EAAa;AAAA,QAC5B,QAAQ,IAAQC,IAAAd,EAAM,UAAN,QAAAc,EAAa;AAAA,QAC7B,MAAM,IAAQC,IAAAf,EAAM,UAAN,QAAAe,EAAa;AAAA,MAC7B;AAGA,MAAAtC,GAAcmC,CAAe,GAG7BN,IAAiBxC,GAAajB,KAAA,gBAAAA,EAAe,aAAY,IAAImD,EAAM,QAAQ,OAAO,GAClFO,IAAkBzC,GAAajB,KAAA,gBAAAA,EAAe,cAAa,IAAImD,EAAM,QAAQ,QAAQ,GACrFQ,IAAiB1C,GAAajB,KAAA,gBAAAA,EAAe,aAAY,OAAUmD,EAAM,QAAQ,OAAO,GACxFS,IAAkB3C,GAAajB,KAAA,gBAAAA,EAAe,cAAa,OAAUmD,EAAM,QAAQ,QAAQ,GAC3FU,IAAoB7C,IAAcE,GAG9BxB,KAAA,QAAAA,EAAW,YACb,sBAAsB,MAAM;;AAC1B,SAAAuD,IAAAvD,EAAU,aAAV,QAAAuD,EAAA,KAAAvD,GAAqB;AAAA,UACnB,MAAM;AAAA,UACN,OAAOsB;AAAA,UACP,QAAQE;AAAA,UACR,KAAKH;AAAA,UACL,MAAMF;AAAA,UACN,YAAY;AAAA,UACZ,aAAa;AAAA,UACb,OAAOkD;AAAA,QAAA;AAAA,MACR,CACF;AAAA,IAEL,GAEMI,IAAmB,CAAChB,MAAuB;;AAE/C,YAAMiB,IAAkB5C,EAAkB,GACpC6C,IAAiB5C,EAAiB,GAClC6C,IAAgB5C,EAAgB,GAChC6C,IAAmB5C,EAAmB,GAItCJ,IACJ4B,EAAM,kBAAkB,cAAc,iBAAiBA,EAAM,MAAM,IAAI,MAGnEqB,MAAavB,KAAAE,EAAM,cAAN,gBAAAF,GAAiB,UAAS,GACvCwB,MAAcT,KAAAb,EAAM,cAAN,gBAAAa,GAAiB,WAAU;AAG/C,UAAIU,IAAqBF,GACrBG,IAAsBF;AAIxB,MAAAzE,KAAA,QAAAA,EAAe,uBACf,CAACoE,KACD,CAACC,KACD,CAACC,KACD,CAACC,OAKGN,KAAAd,EAAM,UAAN,QAAAc,GAAa,SAAQC,KAAAf,EAAM,UAAN,QAAAe,GAAa,QACpCS,IAAsBH,IAAaX,MAC1Be,KAAAzB,EAAM,UAAN,QAAAyB,GAAa,QAAOC,KAAA1B,EAAM,UAAN,QAAA0B,GAAa,YAE1CH,IAAqBD,IAAcZ;AAKvC,UAAIiB,IAAc9D,IAAc0D,GAC5BK,IAAe7D,IAAeyD;AAW9B,UARJG,IAAc,KAAK,IAAIrB,GAAgB,KAAK,IAAIE,GAAgBmB,CAAW,CAAC,GAC5EC,IAAe,KAAK,IAAIrB,GAAiB,KAAK,IAAIE,GAAiBmB,CAAY,CAAC,GAGhFL,IAAqBI,IAAc9D,GACnC2D,IAAsBI,IAAe7D,GAGjCwD,MAAuB,KAAKC,MAAwB;AACtD;AASF,WACGP,KAAmBC,KAAkBC,KAAiBC,MACvDhD,GACA;AAEM,cAAAyD,IAAc7B,EAAM,OAAO,sBAAsB;AACvD,SACE,KAAK,IAAI6B,EAAY,QAAQhE,CAAW,IAAI,KAC5C,KAAK,IAAIgE,EAAY,SAAS9D,CAAY,IAAI,OAE9CF,IAAcgE,EAAY,OAC1B9D,IAAe8D,EAAY;AAAA,MAC7B;AA2CE,UAvCA,CAACZ,KAAmB,CAACC,KAAkB,CAACC,KAAiB,CAACC,OAExDU,KAAA9B,EAAM,UAAN,QAAA8B,GAAa,QACJlE,KAAA4D,KAGTO,KAAA/B,EAAM,UAAN,QAAA+B,GAAa,QAIbC,KAAAhC,EAAM,UAAN,QAAAgC,GAAa,SAIbC,KAAAjC,EAAM,UAAN,QAAAiC,GAAa,SACJvE,KAAA6D,KAKD1D,IAAA8D,GACC5D,IAAA6D,KAKXM,KAAAlC,EAAM,UAAN,QAAAkC,GAAa,SAAQC,KAAAnC,EAAM,UAAN,QAAAmC,GAAa,WACpCnC,EAAM,OAAO,MAAM,QAAQ,GAAGnC,CAAW,SAIvCuE,KAAApC,EAAM,UAAN,QAAAoC,GAAa,QAAOC,KAAArC,EAAM,UAAN,QAAAqC,GAAa,YACnCrC,EAAM,OAAO,MAAM,SAAS,GAAGjC,CAAY,QAOzCuE,KAAAtC,EAAM,UAAN,QAAAsC,GAAa,OAAOlB,GAAkB;AAGxC,cAAMmB,KAAaC,KAAAxC,EAAM,OAAO,kBAAb,gBAAAwC,GAA4B;AAC/C,YAAID,GAAY;AAER,gBAAAE,IAAc,SAAS,iBAAiBzC,EAAM,MAAM,EAAE,UAAU,KAAK,EAAE,GACvE0C,IAASH,EAAW,SAASxE,IAAe0E;AAClD,UAAAzC,EAAM,OAAO,MAAM,MAAM,GAAG0C,CAAM;AAAA,QAAA;AAAA,MACpC;AAIE,WAAAC,KAAA3C,EAAM,UAAN,QAAA2C,GAAa,QAAQ1B,GAAiB;AAGxC,cAAMsB,KAAaK,KAAA5C,EAAM,OAAO,kBAAb,gBAAA4C,GAA4B;AAC/C,YAAIL,GAAY;AAER,gBAAAM,IAAa,SAAS,iBAAiB7C,EAAM,MAAM,EAAE,SAAS,KAAK,EAAE,GACrE8C,IAAUP,EAAW,QAAQ1E,IAAcgF;AACjD,UAAA7C,EAAM,OAAO,MAAM,OAAO,GAAG8C,CAAO;AAAA,QAAA;AAAA,MACtC;AAIE,WAAAC,KAAA/C,EAAM,UAAN,QAAA+C,GAAa,SAAS7B,GAAgB;AAGlC,cAAA8B,IAAY,SAAS,iBAAiBhD,EAAM,MAAM,EAAE,QAAQ,KAAK,EAAE;AAGzE,QAAAA,EAAM,OAAO,MAAM,OAAO,GAAGgD,CAAS;AAAA,MAAA;AAIpC,WAAAC,KAAAjD,EAAM,UAAN,QAAAiD,GAAa,UAAU9B,GAAe;AAGlC,cAAA+B,IAAW,SAAS,iBAAiBlD,EAAM,MAAM,EAAE,OAAO,KAAK,EAAE;AAGvE,QAAAA,EAAM,OAAO,MAAM,MAAM,GAAGkD,CAAQ;AAAA,MAAA;AAKpC,MAAA,CAACjC,KACD,CAACC,KACD,CAACC,KACD,CAACC,KACDzE,MAEAqD,EAAM,OAAO,MAAM,YAAY,aAAatC,CAAO,OAAOE,CAAO;AAOnE,YAAMgD,KAAyC;AAAA,QAC7C,KAAK,IAAQuC,KAAAnD,EAAM,UAAN,QAAAmD,GAAa;AAAA,QAC1B,OAAO,IAAQC,KAAApD,EAAM,UAAN,QAAAoD,GAAa;AAAA,QAC5B,QAAQ,IAAQC,KAAArD,EAAM,UAAN,QAAAqD,GAAa;AAAA,QAC7B,MAAM,IAAQC,KAAAtD,EAAM,UAAN,QAAAsD,GAAa;AAAA,MAC7B;AAGA,MAAI/G,KAAA,QAAAA,EAAW,YACb,sBAAsB,MAAM;;AAC1B,SAAAuD,IAAAvD,EAAU,aAAV,QAAAuD,EAAA,KAAAvD,GAAqB;AAAA,UACnB,MAAM;AAAA,UACN,OAAOsB;AAAA,UACP,QAAQE;AAAA,UACR,KAAKH;AAAA,UACL,MAAMF;AAAA,UACN,YAAA2D;AAAA,UACA,aAAAC;AAAA,UACA,OAAOV;AAAA,QAAA;AAAA,MACR,CACF;AAAA,IAEL,GAEM2C,IAAkB,CAACvD,MAAuB;;AAEjC,MAAA/B,IAAA,IAGTxB,KAAaG,KACf8C,EAAa,UAAU,EAAI,GAIZZ,GAAA,GAKbkB,EAAM,kBAAkB,YAC1BA,EAAM,OAAO,aAAa,UAAUtC,EAAQ,UAAU,GACtDsC,EAAM,OAAO,aAAa,UAAUpC,EAAQ,UAAU,GACtDoC,EAAM,OAAO,aAAa,cAAcnC,EAAY,UAAU,GAC9DmC,EAAM,OAAO,aAAa,eAAejC,EAAa,UAAU;AAIlE,YAAM6C,IAAyC;AAAA,QAC7C,KAAK,IAAQd,IAAAE,EAAM,UAAN,QAAAF,EAAa;AAAA,QAC1B,OAAO,IAAQe,IAAAb,EAAM,UAAN,QAAAa,EAAa;AAAA,QAC5B,QAAQ,IAAQC,IAAAd,EAAM,UAAN,QAAAc,EAAa;AAAA,QAC7B,MAAM,IAAQC,IAAAf,EAAM,UAAN,QAAAe,EAAa;AAAA,MAC7B;AAGA,4BAAsB,MAAM;;AAC1B,SAAAD,IAAAvE,KAAA,gBAAAA,EAAW,aAAX,QAAAuE,EAAA,KAAAvE,GAAsB;AAAA,UACpB,MAAM;AAAA,UACN,OAAOsB;AAAA,UACP,QAAQE;AAAA,UACR,KAAKH;AAAA,UACL,MAAMF;AAAA,UACN,cAAYoC,IAAAE,EAAM,cAAN,gBAAAF,EAAiB,UAAS;AAAA,UACtC,eAAae,IAAAb,EAAM,cAAN,gBAAAa,EAAiB,WAAU;AAAA,UACxC,OAAOD;AAAA,QAAA;AAAA,MACR,CACF;AAAA,IACH,GAMM4C,IAHgBxC,GAMhByC,IAAuB;AAAA,MAC3B,SAAS;AAAA,MACT,QAAO5G,KAAA,gBAAAA,EAAe,UAAS,CAAC;AAAA,MAChC,YAAWA,KAAA,gBAAAA,EAAe,cAAa,CAAC;AAAA,MACxC,WAAW;AAAA,QACT,OAAO8D;AAAA,QACP,MAAM6C;AAAA,QACN,KAAKD;AAAA,MAAA;AAAA,IAET;AAGA,KAAI1G,KAAA,gBAAAA,EAAe,YAAW,WAAW4G,EAAgB,SAAS5G,EAAc,UAC5EA,KAAA,gBAAAA,EAAe,yBAAwB,WACzC4G,EAAgB,sBAAsB5G,EAAc,sBAClDA,KAAA,QAAAA,EAAe,WAAwB4G,EAAA,SAAS5G,EAAc,UAC9DA,KAAA,gBAAAA,EAAe,YAAW,WAAW4G,EAAgB,SAAS5G,EAAc,UAC5EA,KAAA,gBAAAA,EAAe,SAAQ,WAAW4G,EAAgB,MAAM5G,EAAc,OACtEA,KAAA,gBAAAA,EAAe,mBAAkB,WACnC4G,EAAgB,gBAAgB5G,EAAc,iBAC5CA,KAAA,gBAAAA,EAAe,cAAa,WAC9B4G,EAAgB,WAAW3F,EAAajB,EAAc,UAAUR,GAAS,OAAO,KAC9EQ,KAAA,gBAAAA,EAAe,eAAc,WAC/B4G,EAAgB,YAAY3F,EAAajB,EAAc,WAAWR,GAAS,QAAQ,KACjFQ,KAAA,gBAAAA,EAAe,cAAa,WAC9B4G,EAAgB,WAAW3F,EAAajB,EAAc,UAAUR,GAAS,OAAO,KAC9EQ,KAAA,gBAAAA,EAAe,eAAc,WAC/B4G,EAAgB,YAAY3F,EAAajB,EAAc,WAAWR,GAAS,QAAQ;AAEjF,QAAA;AACF,MAAAqD,EAAa,UAAU+D,CAAe;AAAA,aAC/BC,GAAO;AACN,cAAA,MAAM,+BAA+BA,CAAK;AAAA,IAAA;AAAA,EACpD;AAcF,MAVIrH,aAAmB,gBAErBA,EAAQ,MAAM,aAAa,QAGnBA,EAAA,MAAM,QAAQ,GAAGwB,CAAW,MAC5BxB,EAAA,MAAM,SAAS,GAAG0B,CAAY,OAIpC1B,aAAmB,aAAa;AAC5B,UAAA+B,IAAgB,iBAAiB/B,CAAO,GAGxC4D,IAAoB7B,EAAc,aAAa,cAAcA,EAAc,aAAa;AAE1F,IAAAzB,KAAoB,CAACsD,IAEvB5D,EAAQ,MAAM,YAAY,aAAaqB,CAAO,OAAOE,CAAO,QACnDqC,KAEL,CAAC5B,EAAA,KAAuB,CAACC,QACnBjC,EAAA,MAAM,OAAO,GAAGqB,CAAO,OAE7B,CAACa,EAAA,KAAqB,CAACC,QACjBnC,EAAA,MAAM,MAAM,GAAGuB,CAAO,SAIhCvB,EAAQ,MAAM,YAAY,aAAaqB,CAAO,OAAOE,CAAO;AAAA,EAC9D;AAII,QAAA+F,KAAiB,CAACC,GAAuBC,MAA0B;AAMvE,QAJUnG,IAAAC,EAAmBiG,GAAMvH,GAAS,GAAG,GACrCuB,IAAAD,EAAmBkG,GAAMxH,GAAS,GAAG,GAG3CA,aAAmB,aAAa;AAC5B,YAAA+B,IAAgB,iBAAiB/B,CAAO,GACxC4D,IAAoB7B,EAAc,aAAa,cAAcA,EAAc,aAAa,SACxF0F,IAAU,CAACC,MAAyB;AACxC,QAAI,OAAOA,KAAQ,YAAYC,EAAeD,CAAG,KAAK9D,IACpD5D,EAAQ,MAAM,OAAO0H,IAEb1H,EAAA,MAAM,OAAO,GAAGqB,CAAO;AAAA,MAEnC,GACMuG,IAAS,CAACF,MAAyB;AACvC,QAAI,OAAOA,KAAQ,YAAYC,EAAeD,CAAG,KAAK9D,IACpD5D,EAAQ,MAAM,MAAM0H,IAEZ1H,EAAA,MAAM,MAAM,GAAGuB,CAAO;AAAA,MAElC;AACI,MAAAjB,KAAoB,CAACsD,IAEvB5D,EAAQ,MAAM,YAAY,aAAaqB,CAAO,OAAOE,CAAO,QACnDqC,KACT5D,EAAQ,MAAM,QAAQ,IACtBA,EAAQ,MAAM,SAAS,IAGvByH,EAAQF,CAAI,GACZK,EAAOJ,CAAI,KAEXxH,EAAQ,MAAM,YAAY,aAAaqB,CAAO,OAAOE,CAAO;AAAA,IAC9D;AAIF,IAAIvB,aAAmB,YACbA,EAAA,aAAa,UAAU,OAAOuH,KAAS,WAAWA,IAAOlG,EAAQ,UAAU,GAC3ErB,EAAA,aAAa,UAAU,OAAOwH,KAAS,WAAWA,IAAOjG,EAAQ,UAAU;AAAA,EAEvF,GAGMsG,KAAa,CAACC,GAA2BC,MAA+B;AAI5E,QAHAvG,IAAc,OAAOsG,KAAa,WAAWA,IAAWrG,EAAaqG,GAAU9H,GAAS,OAAO,GAC/F0B,IAAe,OAAOqG,KAAc,WAAWA,IAAYtG,EAAasG,GAAW/H,GAAS,QAAQ,GAEhGA,aAAmB,aAAa;AAC5B,YAAAgI,IAAW,CAACN,MAAyB;AACzC,QAAI,OAAOA,KAAQ,YAAYC,EAAeD,CAAG,IAC/C1H,EAAQ,MAAM,QAAQ0H,IAEd1H,EAAA,MAAM,QAAQ,GAAGwB,CAAW;AAAA,MAExC,GACMyG,IAAY,CAACP,MAAyB;AAC1C,QAAI,OAAOA,KAAQ,YAAYC,EAAeD,CAAG,IAC/C1H,EAAQ,MAAM,SAAS0H,IAEf1H,EAAA,MAAM,SAAS,GAAG0B,CAAY;AAAA,MAE1C;AACA,MAAAsG,EAASF,CAAQ,GACjBG,EAAUF,CAAS;AAAA,IAAA;AAGrB,IAAI/H,aAAmB,YACbA,EAAA,aAAa,cAAc,OAAO8H,KAAa,WAAWA,IAAWtG,EAAY,UAAU,GAC3FxB,EAAA,aAAa,eAAe,OAAO+H,KAAc,WAAWA,IAAYrG,EAAa,UAAU;AAAA,EAE3G;AASO,SAAA;AAAA,IACL,SAAS,MAAM;AAEb,MAAAC,EAAY,QAAQ,CAAQY,MAAA;AAE1B,QAAIA,EAAK,uBACFA,EAAA,oBAAoB,cAAcA,EAAK,mBAAmB,GAE7DA,EAAK,uBACFA,EAAA,oBAAoB,cAAcA,EAAK,mBAAmB,GAGjEA,EAAK,OAAO;AAAA,MAAA,CACb;AAGG,UAAA;AACF,QAAAc,EAAa,MAAM;AAAA,eACZgE,GAAO;AACN,gBAAA,MAAM,iCAAiCA,CAAK;AAAA,MAAA;AAAA,IAExD;AAAA,IACA,uBA5B4B,CAACE,GAAuBC,GAAuBM,GAA2BC,MAA+B;AACrI,MAAAT,GAAeC,GAAMC,CAAI,GACzBK,GAAWC,GAAUC,CAAS;AAAA,IAChC;AAAA,IA0BE,gBAAAT;AAAA,IACA,YAAAO;AAAA,EACF;AACF;"}