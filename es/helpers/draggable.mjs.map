{"version":3,"file":"draggable.mjs","sources":["../../src/helpers/draggable.ts"],"sourcesContent":["// 从事件中获取 {x, y} 坐标\r\nexport function getControlPosition(e: MouseEvent) {\r\n  return offsetXYFromParentOf(e)\r\n}\r\n\r\n// 从 offsetParent 计算偏移\r\nexport function offsetXYFromParentOf(evt: MouseEvent) {\r\n  const offsetParent = (evt.target as HTMLElement)?.offsetParent || document.body\r\n  const offsetParentRect =\r\n    (evt as any).offsetParent === document.body\r\n      ? { left: 0, top: 0 }\r\n      : offsetParent.getBoundingClientRect()\r\n\r\n  const x = evt.clientX + offsetParent.scrollLeft - offsetParentRect.left\r\n  const y = evt.clientY + offsetParent.scrollTop - offsetParentRect.top\r\n\r\n  /* const x = Math.round(evt.clientX + offsetParent.scrollLeft - offsetParentRect.left);\r\n  const y = Math.round(evt.clientY + offsetParent.scrollTop - offsetParentRect.top); */\r\n\r\n  return { x, y }\r\n}\r\n\r\n// 创建一个由 <DraggableCore> 事件暴露的数据对象\r\nexport function createCoreData(lastX: number, lastY: number, x: number, y: number) {\r\n  // 状态变化通常（但不总是）是异步的，需要最新值\r\n  const isStart = !isNum(lastX)\r\n\r\n  if (isStart) {\r\n    // 如果是首次移动，将当前 x 和 y 作为上一坐标\r\n    return {\r\n      deltaX: 0,\r\n      deltaY: 0,\r\n      lastX: x,\r\n      lastY: y,\r\n      x,\r\n      y,\r\n    }\r\n  } else {\r\n    // 否则计算增量值\r\n    return {\r\n      deltaX: x - lastX,\r\n      deltaY: y - lastY,\r\n      lastX,\r\n      lastY,\r\n      x,\r\n      y,\r\n    }\r\n  }\r\n}\r\n\r\nfunction isNum(num: unknown): num is number {\r\n  // 判断是否为有效数字（排除 NaN）\r\n  return typeof num === 'number' && !Number.isNaN(num)\r\n}\r\n"],"names":["getControlPosition","e","offsetXYFromParentOf","evt","_a","offsetParent","offsetParentRect","x","y","createCoreData","lastX","lastY","isNum","num"],"mappings":"AACO,SAASA,EAAmBC,GAAe;AAChD,SAAOC,EAAqBD,CAAC;AAC/B;AAGO,SAASC,EAAqBC,GAAiB;AAL/C,MAAAC;AAML,QAAMC,MAAgBD,IAAAD,EAAI,WAAJ,gBAAAC,EAA4B,iBAAgB,SAAS,MACrEE,IACHH,EAAY,iBAAiB,SAAS,OACnC,EAAE,MAAM,GAAG,KAAK,MAChBE,EAAa,sBAAsB,GAEnCE,IAAIJ,EAAI,UAAUE,EAAa,aAAaC,EAAiB,MAC7DE,IAAIL,EAAI,UAAUE,EAAa,YAAYC,EAAiB;AAK3D,SAAA,EAAE,GAAAC,GAAG,GAAAC,EAAE;AAChB;AAGO,SAASC,EAAeC,GAAeC,GAAeJ,GAAWC,GAAW;AAIjF,SAFiBI,EAAMF,CAAK,IAcnB;AAAA,IACL,QAAQH,IAAIG;AAAA,IACZ,QAAQF,IAAIG;AAAA,IACZ,OAAAD;AAAA,IACA,OAAAC;AAAA,IACA,GAAAJ;AAAA,IACA,GAAAC;AAAA,EACF,IAjBO;AAAA,IACL,QAAQ;AAAA,IACR,QAAQ;AAAA,IACR,OAAOD;AAAA,IACP,OAAOC;AAAA,IACP,GAAAD;AAAA,IACA,GAAAC;AAAA,EACF;AAYJ;AAEA,SAASI,EAAMC,GAA6B;AAE1C,SAAO,OAAOA,KAAQ,YAAY,CAAC,OAAO,MAAMA,CAAG;AACrD;"}