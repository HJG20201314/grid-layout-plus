"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const Wt=require("interactjs"),_t=require("@vexip-ui/utils"),qt=2;function jt(i,Ct={},a){const T={...{draggable:!0,resizable:!0,useCssTransforms:!0,dragOptions:{},resizeOptions:{edges:{top:!1,right:!1,bottom:!1,left:!1},margin:8},x:0,y:0,width:0,height:0},...Ct},{draggable:z,resizable:G,useCssTransforms:_,dragOptions:g,resizeOptions:t}=T,q=(e,s)=>i.getAttribute(`data-${e}`)||s,j=(e,s)=>{i.setAttribute(`data-${e}`,s.toString())},Z=i.getBoundingClientRect(),v=T.width||Z.width||0,O=T.height||Z.height||0;j("x",T.x||0),j("y",T.y||0),j("width",v.toString()),j("height",O.toString());const Lt=q("x","0"),wt=q("y","0"),Mt=q("width",v.toString()),Pt=q("height",O.toString()),B=e=>typeof e=="string"&&/(px|%|vw|vh|rem|em|calc\()/i.test(e),N=(e,s,p)=>typeof e=="number"?e:B(e)?x(e,s,p==="x"?"width":"height"):parseFloat(e)||0;let f=N(Lt,i,"x"),h=N(wt,i,"y"),l=x(Mt,i,"width"),m=x(Pt,i,"height");const R=new Map;let J=!1;const V=e=>{if(i instanceof HTMLElement){const s=getComputedStyle(i);return(s.position==="absolute"||s.position==="fixed")&&s[e]!=="auto"&&s[e]!==""}return!1},M=()=>V("right"),D=()=>V("left"),F=()=>V("top"),P=()=>V("bottom"),Ht=e=>{["top","right","bottom","left"].forEach(s=>{const p=R.get(s);p&&(p.style.backgroundColor=e[s]?"rgba(29, 98, 236, 1)":"rgba(29, 98, 236, 0)")})},Tt=()=>{R.forEach(e=>{e.style.backgroundColor="rgba(29, 98, 236, 0)"})},Bt=()=>{const e=(t==null?void 0:t.edges)||{},s=(t==null?void 0:t.margin)??4,p={position:"absolute",backgroundColor:"rgba(29, 98, 236, 0)",pointerEvents:"auto",transition:"background-color 0.1s ease"},u=r=>{const d=()=>{r.style.backgroundColor="rgba(29, 98, 236, 1)"},n=()=>{J||(r.style.backgroundColor="rgba(29, 98, 236, 0)")};r.addEventListener("mouseenter",d),r.addEventListener("mouseleave",n),r._mouseEnterListener=d,r._mouseLeaveListener=n};if(e.top){const r=document.createElement("div");Object.assign(r.style,p,{top:`-${s}px`,left:"0",width:"100%",height:"2px",cursor:"row-resize",zIndex:"10"}),u(r),i.appendChild(r),R.set("top",r)}if(e.right){const r=document.createElement("div");Object.assign(r.style,p,{top:"0",right:`-${s}px`,width:"2px",height:"100%",cursor:"col-resize",zIndex:"10"}),u(r),i.appendChild(r),R.set("right",r)}if(e.bottom){const r=document.createElement("div");Object.assign(r.style,p,{bottom:`-${s}px`,left:"0",width:"100%",height:"2px",cursor:"row-resize",zIndex:"10"}),u(r),i.appendChild(r),R.set("bottom",r)}if(e.left){const r=document.createElement("div");Object.assign(r.style,p,{top:"0",left:`-${s}px`,width:"2px",height:"100%",cursor:"col-resize",zIndex:"10"}),u(r),i.appendChild(r),R.set("left",r)}},Dt=e=>{R.forEach(s=>{s.style.pointerEvents="auto",s.style.display="block"})},L=Wt(i).styleCursor(!1);if(z){const e=d=>{var n;G&&t&&L.resizable(!1),(n=a==null?void 0:a.onDrag)==null||n.call(a,{type:"dragstart",top:h,left:f,deltaX:0,deltaY:0})},s=d=>{if(f+=d.dx,h+=d.dy,d.target instanceof HTMLElement){const n=getComputedStyle(d.target),I=n.position==="absolute"||n.position==="fixed";_&&!I?d.target.style.transform=`translate(${f}px, ${h}px)`:I?(M(),D(),F(),P(),D()?d.target.style.left=`${f}px`:M()?M()&&(d.target.style.right=`${-f}px`):d.target.style.left=`${f}px`,F()?d.target.style.top=`${h}px`:P()?P()&&(d.target.style.bottom=`${-h}px`):d.target.style.top=`${h}px`):d.target.style.transform=`translate(${f}px, ${h}px)`}d.target._dataUpdateTimer||(d.target._dataUpdateTimer=setTimeout(()=>{d.target instanceof Element&&(d.target.setAttribute("data-x",f.toString()),d.target.setAttribute("data-y",h.toString())),delete d.target._dataUpdateTimer},50)),a!=null&&a.onDrag&&requestAnimationFrame(()=>{var n;(n=a.onDrag)==null||n.call(a,{type:"dragmove",top:h,left:f,deltaX:d.dx,deltaY:d.dy})})},p=d=>{var n;G&&t&&L.resizable(!0),d.target instanceof Element&&(d.target.setAttribute("data-x",f.toString()),d.target.setAttribute("data-y",h.toString())),(n=a==null?void 0:a.onDrag)==null||n.call(a,{type:"dragend",top:h,left:f,deltaX:d.dx,deltaY:d.dy})},u=_t.throttle(s,(g==null?void 0:g.threshold)??qt),r={enabled:!0,allowFrom:g==null?void 0:g.allowFrom,ignoreFrom:g==null?void 0:g.ignoreFrom,modifiers:(g==null?void 0:g.modifiers)||[],listeners:{start:e,move:u,end:p}};g!=null&&g.startAxis&&(r.startAxis=g.startAxis),g!=null&&g.lockAxis&&(r.lockAxis=g.lockAxis),(g==null?void 0:g.max)!==void 0&&(r.max=g.max),(g==null?void 0:g.maxPerElement)!==void 0&&(r.maxPerElement=g.maxPerElement),L.draggable(r)}function x(e,s,p="width"){if(typeof e=="number")return e;if(typeof e=="string"&&e.endsWith("px"))return parseFloat(e);const u=document.createElement("div");Object.assign(u.style,{position:"absolute",visibility:"hidden",zIndex:"-1000",margin:"0",padding:"0",border:"none",overflow:"hidden",boxSizing:"border-box",width:p==="width"?typeof e=="string"?e:`${e}px`:"auto",height:p==="height"?typeof e=="string"?e:`${e}px`:"auto"});try{const r=s.parentNode;(r instanceof Node?r:document.body).appendChild(u);const n=getComputedStyle(u),U=parseFloat(n[p==="width"?"width":"height"]);return isNaN(U)||U<=0?100:U}catch{return 100}finally{u.parentNode&&u.parentNode.removeChild(u)}}if(G&&t){Bt();let e=10,s=10,p=1/0,u=1/0,r=l/m;const d=o=>{var E,S,b,w;Dt(),J=!0,z&&g&&L.draggable(!1);const $={top:!!((E=o.edges)!=null&&E.top),right:!!((S=o.edges)!=null&&S.right),bottom:!!((b=o.edges)!=null&&b.bottom),left:!!((w=o.edges)!=null&&w.left)};Ht($),e=x((t==null?void 0:t.minWidth)??10,o.target,"width"),s=x((t==null?void 0:t.minHeight)??10,o.target,"height"),p=x((t==null?void 0:t.maxWidth)??1/0,o.target,"width"),u=x((t==null?void 0:t.maxHeight)??1/0,o.target,"height"),r=l/m,a!=null&&a.onResize&&requestAnimationFrame(()=>{var A;(A=a.onResize)==null||A.call(a,{type:"resizestart",width:l,height:m,top:h,left:f,deltaWidth:0,deltaHeight:0,edges:$})})},n=o=>{var et,ot,it,rt,st,dt,at,gt,nt,ft,ht,pt,ut,lt,mt,yt,xt,ct,Et,St,bt,$t,At,Rt;const $=M(),E=D(),S=F(),b=P(),w=o.target instanceof HTMLElement?getComputedStyle(o.target):null,A=((et=o.deltaRect)==null?void 0:et.width)||0,H=((ot=o.deltaRect)==null?void 0:ot.height)||0;let C=A,W=H;t!=null&&t.preserveAspectRatio&&!$&&!E&&!S&&!b&&((it=o.edges)!=null&&it.left||(rt=o.edges)!=null&&rt.right?W=A/r:((st=o.edges)!=null&&st.top||(dt=o.edges)!=null&&dt.bottom)&&(C=H*r));let Y=l+C,X=m+W;if(Y=Math.max(e,Math.min(p,Y)),X=Math.max(s,Math.min(u,X)),C=Y-l,W=X-m,C===0&&W===0)return;if(($||E||S||b)&&w){const y=o.target.getBoundingClientRect();(Math.abs(y.width-l)>1||Math.abs(y.height-m)>1)&&(l=y.width,m=y.height)}if(!$&&!E&&!S&&!b&&((at=o.edges)!=null&&at.top&&(h-=W),(gt=o.edges)!=null&&gt.right,(nt=o.edges)!=null&&nt.bottom,(ft=o.edges)!=null&&ft.left&&(f-=C)),l=Y,m=X,((ht=o.edges)!=null&&ht.left||(pt=o.edges)!=null&&pt.right)&&(o.target.style.width=`${l}px`),((ut=o.edges)!=null&&ut.top||(lt=o.edges)!=null&&lt.bottom)&&(o.target.style.height=`${m}px`),(mt=o.edges)!=null&&mt.top&&b){const y=(yt=o.target.parentElement)==null?void 0:yt.getBoundingClientRect();if(y){const K=parseInt(getComputedStyle(o.target).bottom||"0",10),Q=y.height-m-K;o.target.style.top=`${Q}px`}}if((xt=o.edges)!=null&&xt.left&&$){const y=(ct=o.target.parentElement)==null?void 0:ct.getBoundingClientRect();if(y){const K=parseInt(getComputedStyle(o.target).right||"0",10),Q=y.width-l-K;o.target.style.left=`${Q}px`}}if((Et=o.edges)!=null&&Et.right&&E){const y=parseInt(getComputedStyle(o.target).left||"0",10);o.target.style.left=`${y}px`}if((St=o.edges)!=null&&St.bottom&&S){const y=parseInt(getComputedStyle(o.target).top||"0",10);o.target.style.top=`${y}px`}!$&&!E&&!S&&!b&&_&&(o.target.style.transform=`translate(${f}px, ${h}px)`);const It={top:!!((bt=o.edges)!=null&&bt.top),right:!!(($t=o.edges)!=null&&$t.right),bottom:!!((At=o.edges)!=null&&At.bottom),left:!!((Rt=o.edges)!=null&&Rt.left)};a!=null&&a.onResize&&requestAnimationFrame(()=>{var y;(y=a.onResize)==null||y.call(a,{type:"resizemove",width:l,height:m,top:h,left:f,deltaWidth:A,deltaHeight:H,edges:It})})},I=o=>{var E,S,b,w;J=!1,z&&g&&L.draggable(!0),Tt(),o.target instanceof Element&&(o.target.setAttribute("data-x",f.toString()),o.target.setAttribute("data-y",h.toString()),o.target.setAttribute("data-width",l.toString()),o.target.setAttribute("data-height",m.toString()));const $={top:!!((E=o.edges)!=null&&E.top),right:!!((S=o.edges)!=null&&S.right),bottom:!!((b=o.edges)!=null&&b.bottom),left:!!((w=o.edges)!=null&&w.left)};requestAnimationFrame(()=>{var A,H,C;(C=a==null?void 0:a.onResize)==null||C.call(a,{type:"resizeend",width:l,height:m,top:h,left:f,deltaWidth:((A=o.deltaRect)==null?void 0:A.width)||0,deltaHeight:((H=o.deltaRect)==null?void 0:H.height)||0,edges:$})})},Ft=n,c={enabled:!0,edges:(t==null?void 0:t.edges)||{},modifiers:(t==null?void 0:t.modifiers)||[],listeners:{start:d,move:Ft,end:I}};(t==null?void 0:t.square)!==void 0&&(c.square=t.square),(t==null?void 0:t.preserveAspectRatio)!==void 0&&(c.preserveAspectRatio=t.preserveAspectRatio),t!=null&&t.invert&&(c.invert=t.invert),(t==null?void 0:t.margin)!==void 0&&(c.margin=t.margin),(t==null?void 0:t.max)!==void 0&&(c.max=t.max),(t==null?void 0:t.maxPerElement)!==void 0&&(c.maxPerElement=t.maxPerElement),(t==null?void 0:t.minWidth)!==void 0&&(c.minWidth=x(t.minWidth,i,"width")),(t==null?void 0:t.minHeight)!==void 0&&(c.minHeight=x(t.minHeight,i,"height")),(t==null?void 0:t.maxWidth)!==void 0&&(c.maxWidth=x(t.maxWidth,i,"width")),(t==null?void 0:t.maxHeight)!==void 0&&(c.maxHeight=x(t.maxHeight,i,"height"));try{L.resizable(c)}catch(o){console.error("Error setting up resizable:",o)}}if(i instanceof HTMLElement&&(i.style.transition="none",i.style.width=`${l}px`,i.style.height=`${m}px`),i instanceof HTMLElement){const e=getComputedStyle(i),s=e.position==="absolute"||e.position==="fixed";_&&!s?i.style.transform=`translate(${f}px, ${h}px)`:s?(!M()&&!D()&&(i.style.left=`${f}px`),!F()&&!P()&&(i.style.top=`${h}px`)):i.style.transform=`translate(${f}px, ${h}px)`}const k=(e,s)=>{if(f=N(e,i,"x"),h=N(s,i,"y"),i instanceof HTMLElement){const p=getComputedStyle(i),u=p.position==="absolute"||p.position==="fixed",r=n=>{typeof n=="string"&&B(n)&&u?i.style.left=n:i.style.left=`${f}px`},d=n=>{typeof n=="string"&&B(n)&&u?i.style.top=n:i.style.top=`${h}px`};_&&!u?i.style.transform=`translate(${f}px, ${h}px)`:u?(!M()&&!D()&&r(e),!F()&&!P()&&d(s)):i.style.transform=`translate(${f}px, ${h}px)`}i instanceof Element&&(i.setAttribute("data-x",typeof e=="string"?e:f.toString()),i.setAttribute("data-y",typeof s=="string"?s:h.toString()))},tt=(e,s)=>{if(l=typeof e=="number"?e:x(e,i,"width"),m=typeof s=="number"?s:x(s,i,"height"),i instanceof HTMLElement){const p=r=>{typeof r=="string"&&B(r)?i.style.width=r:i.style.width=`${l}px`},u=r=>{typeof r=="string"&&B(r)?i.style.height=r:i.style.height=`${m}px`};p(e),u(s)}i instanceof Element&&(i.setAttribute("data-width",typeof e=="string"?e:l.toString()),i.setAttribute("data-height",typeof s=="string"?s:m.toString()))};return{cleanup:()=>{R.forEach(e=>{e._mouseEnterListener&&e.removeEventListener("mouseenter",e._mouseEnterListener),e._mouseLeaveListener&&e.removeEventListener("mouseleave",e._mouseLeaveListener),e.remove()});try{L.unset()}catch(e){console.error("Error unsetting interactable:",e)}},updatePositionAndSize:(e,s,p,u)=>{k(e,s),tt(p,u)},updatePosition:k,updateSize:tt}}exports.makeElementDraggableResizable=jt;
//# sourceMappingURL=interact-helper.cjs.map
