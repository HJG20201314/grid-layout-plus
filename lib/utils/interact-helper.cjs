"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const It=require("interactjs"),jt=require("@vexip-ui/utils"),m=require("./css-units.cjs"),Dt=2;function Vt(i,At={},n){const H={...{draggable:!0,resizable:!0,useCssTransforms:!0,dragOptions:{},resizeOptions:{edges:{top:!1,right:!1,bottom:!1,left:!1},margin:8,hotZoneSize:8},x:0,y:0,width:0,height:0},...At},{draggable:q,resizable:U,useCssTransforms:z,dragOptions:d,resizeOptions:t}=H,B=(s,r)=>i.getAttribute(`data-${s}`)||r,I=(s,r)=>{i.setAttribute(`data-${s}`,r.toString())},N=i.getBoundingClientRect(),Q=H.width||N.width||0,v=H.height||N.height||0;I("x",H.x||0),I("y",H.y||0),I("width",Q.toString()),I("height",v.toString());const Lt=B("x","0"),Rt=B("y","0"),Mt=B("width",Q.toString()),wt=B("height",v.toString());let g=m.parsePositionValue(Lt,i,"x"),h=m.parsePositionValue(Rt,i,"y"),y=m.parseCssSize(Mt,i,"width"),c=m.parseCssSize(wt,i,"height");const L=new Map;let Y=!1;const j=s=>{if(i instanceof HTMLElement){const r=getComputedStyle(i);return(r.position==="absolute"||r.position==="fixed")&&r[s]!=="auto"&&r[s]!==""}return!1},D=()=>j("right"),Z=()=>j("left"),X=()=>j("top"),V=()=>j("bottom"),Pt=s=>{["top","right","bottom","left"].forEach(r=>{const l=L.get(r);if(l){const p=l.firstElementChild;p&&(p.style.backgroundColor=s[r]?"rgba(29, 98, 236, 1)":"rgba(29, 98, 236, 0)")}})},Ht=()=>{L.forEach(s=>{const r=s.firstElementChild;r&&(r.style.backgroundColor="rgba(29, 98, 236, 0)")})},Tt=()=>{const s=(t==null?void 0:t.edges)||{},r=(t==null?void 0:t.margin)??4,l=(t==null?void 0:t.hotZoneSize)??10,p={position:"absolute",backgroundColor:"rgba(29, 98, 236, 0)",pointerEvents:"auto",display:"flex",alignItems:"center",justifyContent:"center"},f={backgroundColor:"rgba(29, 98, 236, 0)",transition:"background-color 0.1s ease",pointerEvents:"auto"},a=(o,u)=>{const G=()=>{u.style.backgroundColor="rgba(29, 98, 236, 1)"},W=()=>{Y||(u.style.backgroundColor="rgba(29, 98, 236, 0)")};o.addEventListener("mouseenter",G),o.addEventListener("mouseleave",W),o._mouseEnterListener=G,o._mouseLeaveListener=W};if(s.top){const o=document.createElement("div"),u=document.createElement("div");Object.assign(o.style,p,{top:`-${l/2+r}px`,left:"0",width:"100%",height:`${l}px`,cursor:"row-resize",zIndex:"10",alignItems:"center",justifyContent:"center"}),Object.assign(u.style,f,{width:"100%",height:"2px"}),o.appendChild(u),a(o,u),i.appendChild(o),L.set("top",o)}if(s.right){const o=document.createElement("div"),u=document.createElement("div");Object.assign(o.style,p,{top:"0",right:`-${l/2+r}px`,width:`${l}px`,height:"100%",cursor:"col-resize",zIndex:"10",alignItems:"center",justifyContent:"center"}),Object.assign(u.style,f,{width:"2px",height:"100%"}),o.appendChild(u),a(o,u),i.appendChild(o),L.set("right",o)}if(s.bottom){const o=document.createElement("div"),u=document.createElement("div");Object.assign(o.style,p,{bottom:`-${l/2+r}px`,left:"0",width:"100%",height:`${l}px`,cursor:"row-resize",zIndex:"10",alignItems:"center",justifyContent:"center"}),Object.assign(u.style,f,{width:"100%",height:"2px"}),o.appendChild(u),a(o,u),i.appendChild(o),L.set("bottom",o)}if(s.left){const o=document.createElement("div"),u=document.createElement("div");Object.assign(o.style,p,{top:"0",left:`-${l/2+r}px`,width:`${l}px`,height:"100%",cursor:"col-resize",zIndex:"10",alignItems:"center",justifyContent:"center"}),Object.assign(u.style,f,{width:"2px",height:"100%"}),o.appendChild(u),a(o,u),i.appendChild(o),L.set("left",o)}},zt=s=>{L.forEach(r=>{r.style.pointerEvents="auto",r.style.display="flex"})},M=It(i).styleCursor(!1);if(q){const s=a=>{var o;U&&t&&M.resizable(!1),(o=n==null?void 0:n.onDrag)==null||o.call(n,{type:"dragstart",top:h,left:g,deltaX:0,deltaY:0})},r=a=>{if(g+=a.dx,h+=a.dy,a.target instanceof HTMLElement){const o=getComputedStyle(a.target),u=o.position==="absolute"||o.position==="fixed";z&&!u?a.target.style.transform=`translate(${g}px, ${h}px)`:u?(Z()?a.target.style.left=`${g}px`:D()?D()&&(a.target.style.right=`${-g}px`):a.target.style.left=`${g}px`,X()?a.target.style.top=`${h}px`:V()?V()&&(a.target.style.bottom=`${-h}px`):a.target.style.top=`${h}px`):a.target.style.transform=`translate(${g}px, ${h}px)`}a.target._dataUpdateTimer||(a.target._dataUpdateTimer=setTimeout(()=>{a.target instanceof Element&&(a.target.setAttribute("data-x",g.toString()),a.target.setAttribute("data-y",h.toString())),delete a.target._dataUpdateTimer},50)),n!=null&&n.onDrag&&requestAnimationFrame(()=>{var o;(o=n.onDrag)==null||o.call(n,{type:"dragmove",top:h,left:g,deltaX:a.dx,deltaY:a.dy})})},l=a=>{var o;U&&t&&M.resizable(!0),a.target instanceof Element&&(a.target.setAttribute("data-x",g.toString()),a.target.setAttribute("data-y",h.toString())),(o=n==null?void 0:n.onDrag)==null||o.call(n,{type:"dragend",top:h,left:g,deltaX:a.dx,deltaY:a.dy})},p=jt.throttle(r,(d==null?void 0:d.threshold)??Dt),f={enabled:!0,allowFrom:d==null?void 0:d.allowFrom,ignoreFrom:d==null?void 0:d.ignoreFrom,modifiers:(d==null?void 0:d.modifiers)||[],listeners:{start:s,move:p,end:l}};d!=null&&d.startAxis&&(f.startAxis=d.startAxis),d!=null&&d.lockAxis&&(f.lockAxis=d.lockAxis),(d==null?void 0:d.max)!==void 0&&(f.max=d.max),(d==null?void 0:d.maxPerElement)!==void 0&&(f.maxPerElement=d.maxPerElement),M.draggable(f)}if(U&&t){Tt();let s=10,r=10,l=1/0,p=1/0,f=y/c;const a=e=>{var C,S,$,w;zt(),Y=!0,q&&d&&M.draggable(!1);const b={top:!!((C=e.edges)!=null&&C.top),right:!!((S=e.edges)!=null&&S.right),bottom:!!(($=e.edges)!=null&&$.bottom),left:!!((w=e.edges)!=null&&w.left)};Pt(b),s=m.parseCssSize((t==null?void 0:t.minWidth)??10,e.target,"width"),r=m.parseCssSize((t==null?void 0:t.minHeight)??10,e.target,"height"),l=m.parseCssSize((t==null?void 0:t.maxWidth)??1/0,e.target,"width"),p=m.parseCssSize((t==null?void 0:t.maxHeight)??1/0,e.target,"height"),f=y/c,n!=null&&n.onResize&&requestAnimationFrame(()=>{var A;(A=n.onResize)==null||A.call(n,{type:"resizestart",width:y,height:c,top:h,left:g,deltaWidth:0,deltaHeight:0,edges:b})})},o=e=>{var tt,et,it,ot,st,rt,at,nt,dt,gt,ht,ft,lt,ut,pt,mt,yt,ct,xt,Et,Ct,St,$t,bt;const b=D(),C=Z(),S=X(),$=V(),w=e.target instanceof HTMLElement?getComputedStyle(e.target):null,A=((tt=e.deltaRect)==null?void 0:tt.width)||0,P=((et=e.deltaRect)==null?void 0:et.height)||0;let R=A,T=P;t!=null&&t.preserveAspectRatio&&!b&&!C&&!S&&!$&&((it=e.edges)!=null&&it.left||(ot=e.edges)!=null&&ot.right?T=A/f:((st=e.edges)!=null&&st.top||(rt=e.edges)!=null&&rt.bottom)&&(R=P*f));let _=y+R,F=c+T;if(_=Math.max(s,Math.min(l,_)),F=Math.max(r,Math.min(p,F)),R=_-y,T=F-c,R===0&&T===0)return;if((b||C||S||$)&&w){const x=e.target.getBoundingClientRect();(Math.abs(x.width-y)>1||Math.abs(x.height-c)>1)&&(y=x.width,c=x.height)}if(!b&&!C&&!S&&!$&&((at=e.edges)!=null&&at.top&&(h-=T),(nt=e.edges)!=null&&nt.right,(dt=e.edges)!=null&&dt.bottom,(gt=e.edges)!=null&&gt.left&&(g-=R)),y=_,c=F,((ht=e.edges)!=null&&ht.left||(ft=e.edges)!=null&&ft.right)&&(e.target.style.width=`${y}px`),((lt=e.edges)!=null&&lt.top||(ut=e.edges)!=null&&ut.bottom)&&(e.target.style.height=`${c}px`),(pt=e.edges)!=null&&pt.top&&$){const x=(mt=e.target.parentElement)==null?void 0:mt.getBoundingClientRect();if(x){const J=parseInt(getComputedStyle(e.target).bottom||"0",10),K=x.height-c-J;e.target.style.top=`${K}px`}}if((yt=e.edges)!=null&&yt.left&&b){const x=(ct=e.target.parentElement)==null?void 0:ct.getBoundingClientRect();if(x){const J=parseInt(getComputedStyle(e.target).right||"0",10),K=x.width-y-J;e.target.style.left=`${K}px`}}if((xt=e.edges)!=null&&xt.right&&C){const x=parseInt(getComputedStyle(e.target).left||"0",10);e.target.style.left=`${x}px`}if((Et=e.edges)!=null&&Et.bottom&&S){const x=parseInt(getComputedStyle(e.target).top||"0",10);e.target.style.top=`${x}px`}!b&&!C&&!S&&!$&&z&&(e.target.style.transform=`translate(${g}px, ${h}px)`);const Bt={top:!!((Ct=e.edges)!=null&&Ct.top),right:!!((St=e.edges)!=null&&St.right),bottom:!!(($t=e.edges)!=null&&$t.bottom),left:!!((bt=e.edges)!=null&&bt.left)};n!=null&&n.onResize&&requestAnimationFrame(()=>{var x;(x=n.onResize)==null||x.call(n,{type:"resizemove",width:y,height:c,top:h,left:g,deltaWidth:A,deltaHeight:P,edges:Bt})})},u=e=>{var C,S,$,w;Y=!1,q&&d&&M.draggable(!0),Ht(),e.target instanceof Element&&(e.target.setAttribute("data-x",g.toString()),e.target.setAttribute("data-y",h.toString()),e.target.setAttribute("data-width",y.toString()),e.target.setAttribute("data-height",c.toString()));const b={top:!!((C=e.edges)!=null&&C.top),right:!!((S=e.edges)!=null&&S.right),bottom:!!(($=e.edges)!=null&&$.bottom),left:!!((w=e.edges)!=null&&w.left)};requestAnimationFrame(()=>{var A,P,R;(R=n==null?void 0:n.onResize)==null||R.call(n,{type:"resizeend",width:y,height:c,top:h,left:g,deltaWidth:((A=e.deltaRect)==null?void 0:A.width)||0,deltaHeight:((P=e.deltaRect)==null?void 0:P.height)||0,edges:b})})},W=o,E={enabled:!0,edges:(t==null?void 0:t.edges)||{},modifiers:(t==null?void 0:t.modifiers)||[],listeners:{start:a,move:W,end:u}};(t==null?void 0:t.square)!==void 0&&(E.square=t.square),(t==null?void 0:t.preserveAspectRatio)!==void 0&&(E.preserveAspectRatio=t.preserveAspectRatio),t!=null&&t.invert&&(E.invert=t.invert),(t==null?void 0:t.margin)!==void 0&&(E.margin=t.margin),(t==null?void 0:t.max)!==void 0&&(E.max=t.max),(t==null?void 0:t.maxPerElement)!==void 0&&(E.maxPerElement=t.maxPerElement),(t==null?void 0:t.minWidth)!==void 0&&(E.minWidth=m.parseCssSize(t.minWidth,i,"width")),(t==null?void 0:t.minHeight)!==void 0&&(E.minHeight=m.parseCssSize(t.minHeight,i,"height")),(t==null?void 0:t.maxWidth)!==void 0&&(E.maxWidth=m.parseCssSize(t.maxWidth,i,"width")),(t==null?void 0:t.maxHeight)!==void 0&&(E.maxHeight=m.parseCssSize(t.maxHeight,i,"height"));try{M.resizable(E)}catch(e){console.error("Error setting up resizable:",e)}}if(i instanceof HTMLElement&&(i.style.transition="none",i.style.width=`${y}px`,i.style.height=`${c}px`),i instanceof HTMLElement){const s=getComputedStyle(i),r=s.position==="absolute"||s.position==="fixed";z&&!r?i.style.transform=`translate(${g}px, ${h}px)`:r?(!D()&&!Z()&&(i.style.left=`${g}px`),!X()&&!V()&&(i.style.top=`${h}px`)):i.style.transform=`translate(${g}px, ${h}px)`}const O=(s,r)=>{if(g=m.parsePositionValue(s,i,"x"),h=m.parsePositionValue(r,i,"y"),i instanceof HTMLElement){const l=getComputedStyle(i),p=l.position==="absolute"||l.position==="fixed",f=o=>{typeof o=="string"&&m.isCssUnitValue(o)&&p?i.style.left=o:i.style.left=`${g}px`},a=o=>{typeof o=="string"&&m.isCssUnitValue(o)&&p?i.style.top=o:i.style.top=`${h}px`};z&&!p?i.style.transform=`translate(${g}px, ${h}px)`:p?(i.style.right="",i.style.bottom="",f(s),a(r)):i.style.transform=`translate(${g}px, ${h}px)`}i instanceof Element&&(i.setAttribute("data-x",typeof s=="string"?s:g.toString()),i.setAttribute("data-y",typeof r=="string"?r:h.toString()))},k=(s,r)=>{if(y=typeof s=="number"?s:m.parseCssSize(s,i,"width"),c=typeof r=="number"?r:m.parseCssSize(r,i,"height"),i instanceof HTMLElement){const l=f=>{typeof f=="string"&&m.isCssUnitValue(f)?i.style.width=f:i.style.width=`${y}px`},p=f=>{typeof f=="string"&&m.isCssUnitValue(f)?i.style.height=f:i.style.height=`${c}px`};l(s),p(r)}i instanceof Element&&(i.setAttribute("data-width",typeof s=="string"?s:y.toString()),i.setAttribute("data-height",typeof r=="string"?r:c.toString()))};return{cleanup:()=>{L.forEach(s=>{s._mouseEnterListener&&s.removeEventListener("mouseenter",s._mouseEnterListener),s._mouseLeaveListener&&s.removeEventListener("mouseleave",s._mouseLeaveListener),s.remove()});try{M.unset()}catch(s){console.error("Error unsetting interactable:",s)}},updatePositionAndSize:(s,r,l,p)=>{O(s,r),k(l,p)},updatePosition:O,updateSize:k}}exports.makeElementDraggableResizable=Vt;
//# sourceMappingURL=interact-helper.cjs.map
