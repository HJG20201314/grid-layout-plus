"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const zt=require("interactjs"),Dt=require("@vexip-ui/utils"),u=require("./css-units.cjs"),Vt=2;function Wt(i,$t={},d){const w={...{draggable:!0,resizable:!0,useCssTransforms:!0,dragOptions:{},resizeOptions:{edges:{top:!1,right:!1,bottom:!1,left:!1},margin:8},x:0,y:0,width:0,height:0},...$t},{draggable:j,resizable:Y,useCssTransforms:V,dragOptions:g,resizeOptions:t}=w,W=(o,r)=>i.getAttribute(`data-${o}`)||r,_=(o,r)=>{i.setAttribute(`data-${o}`,r.toString())},K=i.getBoundingClientRect(),N=w.width||K.width||0,Q=w.height||K.height||0;_("x",w.x||0),_("y",w.y||0),_("width",N.toString()),_("height",Q.toString());const At=W("x","0"),Rt=W("y","0"),bt=W("width",N.toString()),Lt=W("height",Q.toString());let n=u.parsePositionValue(At,i,"x"),f=u.parsePositionValue(Rt,i,"y"),m=u.parseCssSize(bt,i,"width"),x=u.parseCssSize(Lt,i,"height");const R=new Map;let X=!1;const F=o=>{if(i instanceof HTMLElement){const r=getComputedStyle(i);return(r.position==="absolute"||r.position==="fixed")&&r[o]!=="auto"&&r[o]!==""}return!1},P=()=>F("right"),B=()=>F("left"),z=()=>F("top"),H=()=>F("bottom"),Mt=o=>{["top","right","bottom","left"].forEach(r=>{const l=R.get(r);l&&(l.style.backgroundColor=o[r]?"rgba(29, 98, 236, 1)":"rgba(29, 98, 236, 0)")})},Pt=()=>{R.forEach(o=>{o.style.backgroundColor="rgba(29, 98, 236, 0)"})},Ht=()=>{const o=(t==null?void 0:t.edges)||{},r=(t==null?void 0:t.margin)??4,l={position:"absolute",backgroundColor:"rgba(29, 98, 236, 0)",pointerEvents:"auto",transition:"background-color 0.1s ease"},p=s=>{const a=()=>{s.style.backgroundColor="rgba(29, 98, 236, 1)"},h=()=>{X||(s.style.backgroundColor="rgba(29, 98, 236, 0)")};s.addEventListener("mouseenter",a),s.addEventListener("mouseleave",h),s._mouseEnterListener=a,s._mouseLeaveListener=h};if(o.top){const s=document.createElement("div");Object.assign(s.style,l,{top:`-${r}px`,left:"0",width:"100%",height:"2px",cursor:"row-resize",zIndex:"10"}),p(s),i.appendChild(s),R.set("top",s)}if(o.right){const s=document.createElement("div");Object.assign(s.style,l,{top:"0",right:`-${r}px`,width:"2px",height:"100%",cursor:"col-resize",zIndex:"10"}),p(s),i.appendChild(s),R.set("right",s)}if(o.bottom){const s=document.createElement("div");Object.assign(s.style,l,{bottom:`-${r}px`,left:"0",width:"100%",height:"2px",cursor:"row-resize",zIndex:"10"}),p(s),i.appendChild(s),R.set("bottom",s)}if(o.left){const s=document.createElement("div");Object.assign(s.style,l,{top:"0",left:`-${r}px`,width:"2px",height:"100%",cursor:"col-resize",zIndex:"10"}),p(s),i.appendChild(s),R.set("left",s)}},Tt=o=>{R.forEach(r=>{r.style.pointerEvents="auto",r.style.display="block"})},L=zt(i).styleCursor(!1);if(j){const o=a=>{var h;Y&&t&&L.resizable(!1),(h=d==null?void 0:d.onDrag)==null||h.call(d,{type:"dragstart",top:f,left:n,deltaX:0,deltaY:0})},r=a=>{if(n+=a.dx,f+=a.dy,a.target instanceof HTMLElement){const h=getComputedStyle(a.target),I=h.position==="absolute"||h.position==="fixed";V&&!I?a.target.style.transform=`translate(${n}px, ${f}px)`:I?(P(),B(),z(),H(),B()?a.target.style.left=`${n}px`:P()?P()&&(a.target.style.right=`${-n}px`):a.target.style.left=`${n}px`,z()?a.target.style.top=`${f}px`:H()?H()&&(a.target.style.bottom=`${-f}px`):a.target.style.top=`${f}px`):a.target.style.transform=`translate(${n}px, ${f}px)`}a.target._dataUpdateTimer||(a.target._dataUpdateTimer=setTimeout(()=>{a.target instanceof Element&&(a.target.setAttribute("data-x",n.toString()),a.target.setAttribute("data-y",f.toString())),delete a.target._dataUpdateTimer},50)),d!=null&&d.onDrag&&requestAnimationFrame(()=>{var h;(h=d.onDrag)==null||h.call(d,{type:"dragmove",top:f,left:n,deltaX:a.dx,deltaY:a.dy})})},l=a=>{var h;Y&&t&&L.resizable(!0),a.target instanceof Element&&(a.target.setAttribute("data-x",n.toString()),a.target.setAttribute("data-y",f.toString())),(h=d==null?void 0:d.onDrag)==null||h.call(d,{type:"dragend",top:f,left:n,deltaX:a.dx,deltaY:a.dy})},p=Dt.throttle(r,(g==null?void 0:g.threshold)??Vt),s={enabled:!0,allowFrom:g==null?void 0:g.allowFrom,ignoreFrom:g==null?void 0:g.ignoreFrom,modifiers:(g==null?void 0:g.modifiers)||[],listeners:{start:o,move:p,end:l}};g!=null&&g.startAxis&&(s.startAxis=g.startAxis),g!=null&&g.lockAxis&&(s.lockAxis=g.lockAxis),(g==null?void 0:g.max)!==void 0&&(s.max=g.max),(g==null?void 0:g.maxPerElement)!==void 0&&(s.maxPerElement=g.maxPerElement),L.draggable(s)}if(Y&&t){Ht();let o=10,r=10,l=1/0,p=1/0,s=m/x;const a=e=>{var E,S,C,M;Tt(),X=!0,j&&g&&L.draggable(!1);const $={top:!!((E=e.edges)!=null&&E.top),right:!!((S=e.edges)!=null&&S.right),bottom:!!((C=e.edges)!=null&&C.bottom),left:!!((M=e.edges)!=null&&M.left)};Mt($),o=u.parseCssSize((t==null?void 0:t.minWidth)??10,e.target,"width"),r=u.parseCssSize((t==null?void 0:t.minHeight)??10,e.target,"height"),l=u.parseCssSize((t==null?void 0:t.maxWidth)??1/0,e.target,"width"),p=u.parseCssSize((t==null?void 0:t.maxHeight)??1/0,e.target,"height"),s=m/x,d!=null&&d.onResize&&requestAnimationFrame(()=>{var A;(A=d.onResize)==null||A.call(d,{type:"resizestart",width:m,height:x,top:f,left:n,deltaWidth:0,deltaHeight:0,edges:$})})},h=e=>{var O,k,tt,et,it,ot,st,rt,at,dt,gt,nt,ft,ht,ut,lt,pt,mt,xt,yt,ct,Et,St,Ct;const $=P(),E=B(),S=z(),C=H(),M=e.target instanceof HTMLElement?getComputedStyle(e.target):null,A=((O=e.deltaRect)==null?void 0:O.width)||0,T=((k=e.deltaRect)==null?void 0:k.height)||0;let b=A,D=T;t!=null&&t.preserveAspectRatio&&!$&&!E&&!S&&!C&&((tt=e.edges)!=null&&tt.left||(et=e.edges)!=null&&et.right?D=A/s:((it=e.edges)!=null&&it.top||(ot=e.edges)!=null&&ot.bottom)&&(b=T*s));let q=m+b,U=x+D;if(q=Math.max(o,Math.min(l,q)),U=Math.max(r,Math.min(p,U)),b=q-m,D=U-x,b===0&&D===0)return;if(($||E||S||C)&&M){const y=e.target.getBoundingClientRect();(Math.abs(y.width-m)>1||Math.abs(y.height-x)>1)&&(m=y.width,x=y.height)}if(!$&&!E&&!S&&!C&&((st=e.edges)!=null&&st.top&&(f-=D),(rt=e.edges)!=null&&rt.right,(at=e.edges)!=null&&at.bottom,(dt=e.edges)!=null&&dt.left&&(n-=b)),m=q,x=U,((gt=e.edges)!=null&&gt.left||(nt=e.edges)!=null&&nt.right)&&(e.target.style.width=`${m}px`),((ft=e.edges)!=null&&ft.top||(ht=e.edges)!=null&&ht.bottom)&&(e.target.style.height=`${x}px`),(ut=e.edges)!=null&&ut.top&&C){const y=(lt=e.target.parentElement)==null?void 0:lt.getBoundingClientRect();if(y){const G=parseInt(getComputedStyle(e.target).bottom||"0",10),J=y.height-x-G;e.target.style.top=`${J}px`}}if((pt=e.edges)!=null&&pt.left&&$){const y=(mt=e.target.parentElement)==null?void 0:mt.getBoundingClientRect();if(y){const G=parseInt(getComputedStyle(e.target).right||"0",10),J=y.width-m-G;e.target.style.left=`${J}px`}}if((xt=e.edges)!=null&&xt.right&&E){const y=parseInt(getComputedStyle(e.target).left||"0",10);e.target.style.left=`${y}px`}if((yt=e.edges)!=null&&yt.bottom&&S){const y=parseInt(getComputedStyle(e.target).top||"0",10);e.target.style.top=`${y}px`}!$&&!E&&!S&&!C&&V&&(e.target.style.transform=`translate(${n}px, ${f}px)`);const Bt={top:!!((ct=e.edges)!=null&&ct.top),right:!!((Et=e.edges)!=null&&Et.right),bottom:!!((St=e.edges)!=null&&St.bottom),left:!!((Ct=e.edges)!=null&&Ct.left)};d!=null&&d.onResize&&requestAnimationFrame(()=>{var y;(y=d.onResize)==null||y.call(d,{type:"resizemove",width:m,height:x,top:f,left:n,deltaWidth:A,deltaHeight:T,edges:Bt})})},I=e=>{var E,S,C,M;X=!1,j&&g&&L.draggable(!0),Pt(),e.target instanceof Element&&(e.target.setAttribute("data-x",n.toString()),e.target.setAttribute("data-y",f.toString()),e.target.setAttribute("data-width",m.toString()),e.target.setAttribute("data-height",x.toString()));const $={top:!!((E=e.edges)!=null&&E.top),right:!!((S=e.edges)!=null&&S.right),bottom:!!((C=e.edges)!=null&&C.bottom),left:!!((M=e.edges)!=null&&M.left)};requestAnimationFrame(()=>{var A,T,b;(b=d==null?void 0:d.onResize)==null||b.call(d,{type:"resizeend",width:m,height:x,top:f,left:n,deltaWidth:((A=e.deltaRect)==null?void 0:A.width)||0,deltaHeight:((T=e.deltaRect)==null?void 0:T.height)||0,edges:$})})},wt=h,c={enabled:!0,edges:(t==null?void 0:t.edges)||{},modifiers:(t==null?void 0:t.modifiers)||[],listeners:{start:a,move:wt,end:I}};(t==null?void 0:t.square)!==void 0&&(c.square=t.square),(t==null?void 0:t.preserveAspectRatio)!==void 0&&(c.preserveAspectRatio=t.preserveAspectRatio),t!=null&&t.invert&&(c.invert=t.invert),(t==null?void 0:t.margin)!==void 0&&(c.margin=t.margin),(t==null?void 0:t.max)!==void 0&&(c.max=t.max),(t==null?void 0:t.maxPerElement)!==void 0&&(c.maxPerElement=t.maxPerElement),(t==null?void 0:t.minWidth)!==void 0&&(c.minWidth=u.parseCssSize(t.minWidth,i,"width")),(t==null?void 0:t.minHeight)!==void 0&&(c.minHeight=u.parseCssSize(t.minHeight,i,"height")),(t==null?void 0:t.maxWidth)!==void 0&&(c.maxWidth=u.parseCssSize(t.maxWidth,i,"width")),(t==null?void 0:t.maxHeight)!==void 0&&(c.maxHeight=u.parseCssSize(t.maxHeight,i,"height"));try{L.resizable(c)}catch(e){console.error("Error setting up resizable:",e)}}if(i instanceof HTMLElement&&(i.style.transition="none",i.style.width=`${m}px`,i.style.height=`${x}px`),i instanceof HTMLElement){const o=getComputedStyle(i),r=o.position==="absolute"||o.position==="fixed";V&&!r?i.style.transform=`translate(${n}px, ${f}px)`:r?(!P()&&!B()&&(i.style.left=`${n}px`),!z()&&!H()&&(i.style.top=`${f}px`)):i.style.transform=`translate(${n}px, ${f}px)`}const Z=(o,r)=>{if(n=u.parsePositionValue(o,i,"x"),f=u.parsePositionValue(r,i,"y"),i instanceof HTMLElement){const l=getComputedStyle(i),p=l.position==="absolute"||l.position==="fixed",s=h=>{typeof h=="string"&&u.isCssUnitValue(h)&&p?i.style.left=h:i.style.left=`${n}px`},a=h=>{typeof h=="string"&&u.isCssUnitValue(h)&&p?i.style.top=h:i.style.top=`${f}px`};V&&!p?i.style.transform=`translate(${n}px, ${f}px)`:p?(!P()&&!B()&&s(o),!z()&&!H()&&a(r)):i.style.transform=`translate(${n}px, ${f}px)`}i instanceof Element&&(i.setAttribute("data-x",typeof o=="string"?o:n.toString()),i.setAttribute("data-y",typeof r=="string"?r:f.toString()))},v=(o,r)=>{if(m=typeof o=="number"?o:u.parseCssSize(o,i,"width"),x=typeof r=="number"?r:u.parseCssSize(r,i,"height"),i instanceof HTMLElement){const l=s=>{typeof s=="string"&&u.isCssUnitValue(s)?i.style.width=s:i.style.width=`${m}px`},p=s=>{typeof s=="string"&&u.isCssUnitValue(s)?i.style.height=s:i.style.height=`${x}px`};l(o),p(r)}i instanceof Element&&(i.setAttribute("data-width",typeof o=="string"?o:m.toString()),i.setAttribute("data-height",typeof r=="string"?r:x.toString()))};return{cleanup:()=>{R.forEach(o=>{o._mouseEnterListener&&o.removeEventListener("mouseenter",o._mouseEnterListener),o._mouseLeaveListener&&o.removeEventListener("mouseleave",o._mouseLeaveListener),o.remove()});try{L.unset()}catch(o){console.error("Error unsetting interactable:",o)}},updatePositionAndSize:(o,r,l,p)=>{Z(o,r),v(l,p)},updatePosition:Z,updateSize:v}}exports.makeElementDraggableResizable=Wt;
//# sourceMappingURL=interact-helper.cjs.map
