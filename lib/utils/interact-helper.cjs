"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const Dt=require("interactjs"),Wt=require("@vexip-ui/utils"),It=2;function _t(s,At={},a){const T={...{draggable:!0,resizable:!0,useCssTransforms:!0,dragOptions:{},resizeOptions:{edges:{top:!1,right:!1,bottom:!1,left:!1},margin:8},x:0,y:0,width:0,height:0},...At},{draggable:U,resizable:Y,useCssTransforms:I,dragOptions:g,resizeOptions:t}=T,_=(o,i)=>s.getAttribute(`data-${o}`)||i,q=(o,i)=>{s.setAttribute(`data-${o}`,i.toString())},K=s.getBoundingClientRect(),Q=T.width||K.width||0,Z=T.height||K.height||0;q("x",T.x||0),q("y",T.y||0),q("width",Q.toString()),q("height",Z.toString());const Rt=_("x","0"),Ct=_("y","0"),Lt=_("width",Q.toString()),wt=_("height",Z.toString()),A=new Map;let X=!1;const j=o=>{if(s instanceof HTMLElement){const i=getComputedStyle(s);return(i.position==="absolute"||i.position==="fixed")&&i[o]!=="auto"&&i[o]!==""}return!1},M=()=>j("right"),B=()=>j("left"),F=()=>j("top"),P=()=>j("bottom");let n=parseFloat(Rt),h=parseFloat(Ct),p=parseFloat(Lt),x=parseFloat(wt);const Mt=o=>{["top","right","bottom","left"].forEach(i=>{const f=A.get(i);f&&(f.style.backgroundColor=o[i]?"rgba(29, 98, 236, 1)":"rgba(29, 98, 236, 0)")})},Pt=()=>{A.forEach(o=>{o.style.backgroundColor="rgba(29, 98, 236, 0)"})},Ht=()=>{const o=(t==null?void 0:t.edges)||{},i=(t==null?void 0:t.margin)??4,f={position:"absolute",backgroundColor:"rgba(29, 98, 236, 0)",pointerEvents:"auto",transition:"background-color 0.1s ease"},l=r=>{const d=()=>{r.style.backgroundColor="rgba(29, 98, 236, 1)"},u=()=>{X||(r.style.backgroundColor="rgba(29, 98, 236, 0)")};r.addEventListener("mouseenter",d),r.addEventListener("mouseleave",u),r._mouseEnterListener=d,r._mouseLeaveListener=u};if(o.top){const r=document.createElement("div");Object.assign(r.style,f,{top:`-${i}px`,left:"0",width:"100%",height:"2px",cursor:"row-resize",zIndex:"10"}),l(r),s.appendChild(r),A.set("top",r)}if(o.right){const r=document.createElement("div");Object.assign(r.style,f,{top:"0",right:`-${i}px`,width:"2px",height:"100%",cursor:"col-resize",zIndex:"10"}),l(r),s.appendChild(r),A.set("right",r)}if(o.bottom){const r=document.createElement("div");Object.assign(r.style,f,{bottom:`-${i}px`,left:"0",width:"100%",height:"2px",cursor:"row-resize",zIndex:"10"}),l(r),s.appendChild(r),A.set("bottom",r)}if(o.left){const r=document.createElement("div");Object.assign(r.style,f,{top:"0",left:`-${i}px`,width:"2px",height:"100%",cursor:"col-resize",zIndex:"10"}),l(r),s.appendChild(r),A.set("left",r)}},Tt=o=>{A.forEach(i=>{i.style.pointerEvents="auto",i.style.display="block"})},L=Dt(s).styleCursor(!1);if(U){const o=d=>{var u;Y&&t&&L.resizable(!1),(u=a==null?void 0:a.onDrag)==null||u.call(a,{type:"dragstart",top:h,left:n,deltaX:0,deltaY:0})},i=d=>{if(n+=d.dx,h+=d.dy,d.target instanceof HTMLElement){const u=getComputedStyle(d.target),D=u.position==="absolute"||u.position==="fixed";I&&!D?d.target.style.transform=`translate(${n}px, ${h}px)`:D?(M(),B(),F(),P(),B()?d.target.style.left=`${n}px`:M()?M()&&(d.target.style.right=`${-n}px`):d.target.style.left=`${n}px`,F()?d.target.style.top=`${h}px`:P()?P()&&(d.target.style.bottom=`${-h}px`):d.target.style.top=`${h}px`):d.target.style.transform=`translate(${n}px, ${h}px)`}d.target._dataUpdateTimer||(d.target._dataUpdateTimer=setTimeout(()=>{d.target instanceof Element&&(d.target.setAttribute("data-x",n.toString()),d.target.setAttribute("data-y",h.toString())),delete d.target._dataUpdateTimer},50)),a!=null&&a.onDrag&&requestAnimationFrame(()=>{var u;(u=a.onDrag)==null||u.call(a,{type:"dragmove",top:h,left:n,deltaX:d.dx,deltaY:d.dy})})},f=d=>{var u;Y&&t&&L.resizable(!0),d.target instanceof Element&&(d.target.setAttribute("data-x",n.toString()),d.target.setAttribute("data-y",h.toString())),(u=a==null?void 0:a.onDrag)==null||u.call(a,{type:"dragend",top:h,left:n,deltaX:d.dx,deltaY:d.dy})},l=Wt.throttle(i,(g==null?void 0:g.threshold)??It),r={enabled:!0,allowFrom:g==null?void 0:g.allowFrom,ignoreFrom:g==null?void 0:g.ignoreFrom,modifiers:(g==null?void 0:g.modifiers)||[],listeners:{start:o,move:l,end:f}};g!=null&&g.startAxis&&(r.startAxis=g.startAxis),g!=null&&g.lockAxis&&(r.lockAxis=g.lockAxis),(g==null?void 0:g.max)!==void 0&&(r.max=g.max),(g==null?void 0:g.maxPerElement)!==void 0&&(r.maxPerElement=g.maxPerElement),L.draggable(r)}const R=(o,i,f="width")=>{if(typeof o=="number")return o;if(o.endsWith("px"))return parseFloat(o);const l=document.createElement("div");Object.assign(l.style,{position:"absolute",visibility:"hidden",zIndex:"-1000",margin:"0",padding:"0",border:"none",overflow:"hidden",boxSizing:"border-box",width:f==="width"?o:"auto",height:f==="height"?o:"auto"});try{const r=i.parentNode;(r instanceof Node?r:document.body).appendChild(l);const u=getComputedStyle(l),N=parseFloat(u[f==="width"?"width":"height"]);return isNaN(N)||N<=0?100:N}catch{return 100}finally{l.parentNode&&l.parentNode.removeChild(l)}};if(Y&&t){Ht();let o=10,i=10,f=1/0,l=1/0,r=p/x;const d=e=>{var c,E,S,w;Tt(),X=!0,U&&g&&L.draggable(!1);const $={top:!!((c=e.edges)!=null&&c.top),right:!!((E=e.edges)!=null&&E.right),bottom:!!((S=e.edges)!=null&&S.bottom),left:!!((w=e.edges)!=null&&w.left)};Mt($),o=R((t==null?void 0:t.minWidth)??10,e.target,"width"),i=R((t==null?void 0:t.minHeight)??10,e.target,"height"),f=R((t==null?void 0:t.maxWidth)??1/0,e.target,"width"),l=R((t==null?void 0:t.maxHeight)??1/0,e.target,"height"),r=p/x,a!=null&&a.onResize&&requestAnimationFrame(()=>{var b;(b=a.onResize)==null||b.call(a,{type:"resizestart",width:p,height:x,top:h,left:n,deltaWidth:0,deltaHeight:0,edges:$})})},u=e=>{var k,tt,et,ot,it,rt,st,at,dt,gt,nt,ht,ft,lt,ut,mt,pt,xt,yt,ct,Et,St,$t,bt;const $=M(),c=B(),E=F(),S=P(),w=e.target instanceof HTMLElement?getComputedStyle(e.target):null,b=((k=e.deltaRect)==null?void 0:k.width)||0,H=((tt=e.deltaRect)==null?void 0:tt.height)||0;let C=b,W=H;t!=null&&t.preserveAspectRatio&&!$&&!c&&!E&&!S&&((et=e.edges)!=null&&et.left||(ot=e.edges)!=null&&ot.right?W=b/r:((it=e.edges)!=null&&it.top||(rt=e.edges)!=null&&rt.bottom)&&(C=H*r));let z=p+C,V=x+W;if(z=Math.max(o,Math.min(f,z)),V=Math.max(i,Math.min(l,V)),C=z-p,W=V-x,C===0&&W===0)return;if(($||c||E||S)&&w){const m=e.target.getBoundingClientRect();(Math.abs(m.width-p)>1||Math.abs(m.height-x)>1)&&(p=m.width,x=m.height)}if(!$&&!c&&!E&&!S&&((st=e.edges)!=null&&st.top&&(h-=W),(at=e.edges)!=null&&at.right,(dt=e.edges)!=null&&dt.bottom,(gt=e.edges)!=null&&gt.left&&(n-=C)),p=z,x=V,((nt=e.edges)!=null&&nt.left||(ht=e.edges)!=null&&ht.right)&&(e.target.style.width=`${p}px`),((ft=e.edges)!=null&&ft.top||(lt=e.edges)!=null&&lt.bottom)&&(e.target.style.height=`${x}px`),(ut=e.edges)!=null&&ut.top&&S){const m=(mt=e.target.parentElement)==null?void 0:mt.getBoundingClientRect();if(m){const G=parseInt(getComputedStyle(e.target).bottom||"0",10),J=m.height-x-G;e.target.style.top=`${J}px`}}if((pt=e.edges)!=null&&pt.left&&$){const m=(xt=e.target.parentElement)==null?void 0:xt.getBoundingClientRect();if(m){const G=parseInt(getComputedStyle(e.target).right||"0",10),J=m.width-p-G;e.target.style.left=`${J}px`}}if((yt=e.edges)!=null&&yt.right&&c){const m=parseInt(getComputedStyle(e.target).left||"0",10);e.target.style.left=`${m}px`}if((ct=e.edges)!=null&&ct.bottom&&E){const m=parseInt(getComputedStyle(e.target).top||"0",10);e.target.style.top=`${m}px`}!$&&!c&&!E&&!S&&I&&(e.target.style.transform=`translate(${n}px, ${h}px)`);const Ft={top:!!((Et=e.edges)!=null&&Et.top),right:!!((St=e.edges)!=null&&St.right),bottom:!!(($t=e.edges)!=null&&$t.bottom),left:!!((bt=e.edges)!=null&&bt.left)};a!=null&&a.onResize&&requestAnimationFrame(()=>{var m;(m=a.onResize)==null||m.call(a,{type:"resizemove",width:p,height:x,top:h,left:n,deltaWidth:b,deltaHeight:H,edges:Ft})})},D=e=>{var c,E,S,w;X=!1,U&&g&&L.draggable(!0),Pt(),e.target instanceof Element&&(e.target.setAttribute("data-x",n.toString()),e.target.setAttribute("data-y",h.toString()),e.target.setAttribute("data-width",p.toString()),e.target.setAttribute("data-height",x.toString()));const $={top:!!((c=e.edges)!=null&&c.top),right:!!((E=e.edges)!=null&&E.right),bottom:!!((S=e.edges)!=null&&S.bottom),left:!!((w=e.edges)!=null&&w.left)};requestAnimationFrame(()=>{var b,H,C;(C=a==null?void 0:a.onResize)==null||C.call(a,{type:"resizeend",width:p,height:x,top:h,left:n,deltaWidth:((b=e.deltaRect)==null?void 0:b.width)||0,deltaHeight:((H=e.deltaRect)==null?void 0:H.height)||0,edges:$})})},Bt=u,y={enabled:!0,edges:(t==null?void 0:t.edges)||{},modifiers:(t==null?void 0:t.modifiers)||[],listeners:{start:d,move:Bt,end:D}};(t==null?void 0:t.square)!==void 0&&(y.square=t.square),(t==null?void 0:t.preserveAspectRatio)!==void 0&&(y.preserveAspectRatio=t.preserveAspectRatio),t!=null&&t.invert&&(y.invert=t.invert),(t==null?void 0:t.margin)!==void 0&&(y.margin=t.margin),(t==null?void 0:t.max)!==void 0&&(y.max=t.max),(t==null?void 0:t.maxPerElement)!==void 0&&(y.maxPerElement=t.maxPerElement),(t==null?void 0:t.minWidth)!==void 0&&(y.minWidth=R(t.minWidth,s,"width")),(t==null?void 0:t.minHeight)!==void 0&&(y.minHeight=R(t.minHeight,s,"height")),(t==null?void 0:t.maxWidth)!==void 0&&(y.maxWidth=R(t.maxWidth,s,"width")),(t==null?void 0:t.maxHeight)!==void 0&&(y.maxHeight=R(t.maxHeight,s,"height"));try{L.resizable(y)}catch(e){console.error("Error setting up resizable:",e)}}if(s instanceof HTMLElement&&(s.style.transition="none",s.style.width=`${p}px`,s.style.height=`${x}px`),s instanceof HTMLElement){const o=getComputedStyle(s),i=o.position==="absolute"||o.position==="fixed";I&&!i?s.style.transform=`translate(${n}px, ${h}px)`:i?(!M()&&!B()&&(s.style.left=`${n}px`),!F()&&!P()&&(s.style.top=`${h}px`)):s.style.transform=`translate(${n}px, ${h}px)`}const v=(o,i)=>{if(n=o,h=i,s instanceof HTMLElement){const f=getComputedStyle(s),l=f.position==="absolute"||f.position==="fixed";I&&!l?s.style.transform=`translate(${o}px, ${i}px)`:l?(!M()&&!B()&&(s.style.left=`${o}px`),!F()&&!P()&&(s.style.top=`${i}px`)):s.style.transform=`translate(${o}px, ${i}px)`}s instanceof Element&&(s.setAttribute("data-x",o.toString()),s.setAttribute("data-y",i.toString()))},O=(o,i)=>{p=o,x=i,s instanceof HTMLElement&&(s.style.width=`${o}px`,s.style.height=`${i}px`),s instanceof Element&&(s.setAttribute("data-width",o.toString()),s.setAttribute("data-height",i.toString()))};return{cleanup:()=>{A.forEach(o=>{o._mouseEnterListener&&o.removeEventListener("mouseenter",o._mouseEnterListener),o._mouseLeaveListener&&o.removeEventListener("mouseleave",o._mouseLeaveListener),o.remove()});try{L.unset()}catch(o){console.error("Error unsetting interactable:",o)}},updatePositionAndSize:(o,i,f,l)=>{v(o,i),O(f,l)},updatePosition:v,updateSize:O}}exports.makeElementDraggableResizable=_t;
//# sourceMappingURL=interact-helper.cjs.map
